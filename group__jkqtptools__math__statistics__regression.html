<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>JKQTPlotter: Regression Analysis</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="jkqtplotter_stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">JKQTPlotter
   </div>
   <div id="projectbrief">an extensive Qt5 Plotter framework (including a feature-richt plotter widget, a speed-optimized, but limited variant and a LaTeX equation renderer!), written fully in C/C++ and without external dependencies</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('group__jkqtptools__math__statistics__regression.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Regression Analysis<div class="ingroups"><a class="el" href="group__jkqtptools.html">Support Function library (e.g. for JKQTPlotter)</a> &raquo; <a class="el" href="group__jkqtptools__math.html">Mathematical Computations &amp; Expression Parsing</a> &raquo; <a class="el" href="group__jkqtptools__math__statistics.html">Statistical Computations</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Collaboration diagram for Regression Analysis:</div>
<div class="dyncontent">
<div class="center"><img src="group__jkqtptools__math__statistics__regression.png" border="0" usemap="#agroup____jkqtptools____math____statistics____regression" alt=""/></div>
<map name="group____jkqtptools____math____statistics____regression" id="agroup____jkqtptools____math____statistics____regression">
<area shape="rect" title=" " alt="" coords="268,5,445,33"/>
<area shape="rect" href="group__jkqtptools__math__statistics.html" title=" " alt="" coords="5,5,220,33"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:gaa798f2573e7f03cb328b15ff76dda335"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__jkqtptools__math__statistics__regression.html#gaa798f2573e7f03cb328b15ff76dda335">JKQTPStatRegressionModelType</a> { <br />
&#160;&#160;<a class="el" href="group__jkqtptools__math__statistics__regression.html#ggaa798f2573e7f03cb328b15ff76dda335a32a843da6ea40ab3b17a3421ccdf671b">JKQTPStatRegressionModelType::Linear</a>, 
<br />
&#160;&#160;<a class="el" href="group__jkqtptools__math__statistics__regression.html#ggaa798f2573e7f03cb328b15ff76dda335a0421fde669f1f6a68f34f112af7c8809">JKQTPStatRegressionModelType::PowerLaw</a>, 
<br />
&#160;&#160;<a class="el" href="group__jkqtptools__math__statistics__regression.html#ggaa798f2573e7f03cb328b15ff76dda335ac1e19c09f700938f0ff7f1fd4722a3ac">JKQTPStatRegressionModelType::Exponential</a>, 
<br />
&#160;&#160;<a class="el" href="group__jkqtptools__math__statistics__regression.html#ggaa798f2573e7f03cb328b15ff76dda335a1e62c0f2dbc49df5365500269be663e0">JKQTPStatRegressionModelType::Logarithm</a>
<br />
 }</td></tr>
<tr class="memdesc:gaa798f2573e7f03cb328b15ff76dda335"><td class="mdescLeft">&#160;</td><td class="mdescRight">when performing linear regression, different target functions can be fitted, if the input data is transformed accordingly. This library provides the options in this enum by default.  <a href="group__jkqtptools__math__statistics__regression.html#gaa798f2573e7f03cb328b15ff76dda335">More...</a><br /></td></tr>
<tr class="separator:gaa798f2573e7f03cb328b15ff76dda335"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gaa01b3052e689312965761795abcdea4b"><td class="memTemplParams" colspan="2">template&lt;class InputItX , class InputItY &gt; </td></tr>
<tr class="memitem:gaa01b3052e689312965761795abcdea4b"><td class="memTemplItemLeft" align="right" valign="top">double&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__jkqtptools__math__statistics__regression.html#gaa01b3052e689312965761795abcdea4b">jkqtpstatCoefficientOfDetermination</a> (InputItX firstX, InputItX lastX, InputItY firstY, InputItY lastY, std::function&lt; double(double)&gt; f)</td></tr>
<tr class="memdesc:gaa01b3052e689312965761795abcdea4b"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculates the coefficient of determination <img class="formulaInl" alt="$ R^2 $" src="form_166.png" width="18" height="15"/> for a set of measurements <img class="formulaInl" alt="$ (x_i,y_i) $" src="form_122.png" width="47" height="18"/> with a fit function <img class="formulaInl" alt="$ f(x) $" src="form_88.png" width="31" height="18"/>  <a href="group__jkqtptools__math__statistics__regression.html#gaa01b3052e689312965761795abcdea4b">More...</a><br /></td></tr>
<tr class="separator:gaa01b3052e689312965761795abcdea4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6f80dbd6d93295db2cd71bb231546ce3"><td class="memItemLeft" align="right" valign="top">JKQTCOMMON_LIB_EXPORT std::pair&lt; std::function&lt; double(double)&gt;, std::function&lt; double(double)&gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__jkqtptools__math__statistics__regression.html#ga6f80dbd6d93295db2cd71bb231546ce3">jkqtpStatGenerateParameterATransformation</a> (<a class="el" href="group__jkqtptools__math__statistics__regression.html#gaa798f2573e7f03cb328b15ff76dda335">JKQTPStatRegressionModelType</a> type)</td></tr>
<tr class="memdesc:ga6f80dbd6d93295db2cd71bb231546ce3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates the transformation function for a-parameter (offset, <code>result.first</code> : transform, <code>result.second</code> : back-transform) for each regression model in JKQTPStatRegressionModelType in <em>type</em>.  <a href="group__jkqtptools__math__statistics__regression.html#ga6f80dbd6d93295db2cd71bb231546ce3">More...</a><br /></td></tr>
<tr class="separator:ga6f80dbd6d93295db2cd71bb231546ce3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6606355626d9d9973c867a68c9bfeac4"><td class="memItemLeft" align="right" valign="top">JKQTCOMMON_LIB_EXPORT std::pair&lt; std::function&lt; double(double)&gt;, std::function&lt; double(double)&gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__jkqtptools__math__statistics__regression.html#ga6606355626d9d9973c867a68c9bfeac4">jkqtpStatGenerateParameterBTransformation</a> (<a class="el" href="group__jkqtptools__math__statistics__regression.html#gaa798f2573e7f03cb328b15ff76dda335">JKQTPStatRegressionModelType</a> type)</td></tr>
<tr class="memdesc:ga6606355626d9d9973c867a68c9bfeac4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates the transformation function for b-parameter (slope, <code>result.first</code> : transform, <code>result.second</code> : back-transform) for each regression model in JKQTPStatRegressionModelType in <em>type</em>.  <a href="group__jkqtptools__math__statistics__regression.html#ga6606355626d9d9973c867a68c9bfeac4">More...</a><br /></td></tr>
<tr class="separator:ga6606355626d9d9973c867a68c9bfeac4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4d8e68bdb86c24be6ef6595135697988"><td class="memItemLeft" align="right" valign="top">JKQTCOMMON_LIB_EXPORT std::function&lt; double(double, double, double)&gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__jkqtptools__math__statistics__regression.html#ga4d8e68bdb86c24be6ef6595135697988">jkqtpStatGenerateRegressionModel</a> (<a class="el" href="group__jkqtptools__math__statistics__regression.html#gaa798f2573e7f03cb328b15ff76dda335">JKQTPStatRegressionModelType</a> type)</td></tr>
<tr class="memdesc:ga4d8e68bdb86c24be6ef6595135697988"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates functors <code>f(x,a,b)</code> for the models from JKQTPStatRegressionModelType in <em>type</em>.  <a href="group__jkqtptools__math__statistics__regression.html#ga4d8e68bdb86c24be6ef6595135697988">More...</a><br /></td></tr>
<tr class="separator:ga4d8e68bdb86c24be6ef6595135697988"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae88cfb4b245c136f85f2403b4458ea52"><td class="memItemLeft" align="right" valign="top">JKQTCOMMON_LIB_EXPORT std::function&lt; double(double)&gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__jkqtptools__math__statistics__regression.html#gae88cfb4b245c136f85f2403b4458ea52">jkqtpStatGenerateRegressionModel</a> (<a class="el" href="group__jkqtptools__math__statistics__regression.html#gaa798f2573e7f03cb328b15ff76dda335">JKQTPStatRegressionModelType</a> type, double a, double b)</td></tr>
<tr class="memdesc:gae88cfb4b245c136f85f2403b4458ea52"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates functors <code>f(x)</code> for the models from JKQTPStatRegressionModelType in <em>type</em> and binds the parameter values <em>and</em> <em>b</em> to the returned function.  <a href="group__jkqtptools__math__statistics__regression.html#gae88cfb4b245c136f85f2403b4458ea52">More...</a><br /></td></tr>
<tr class="separator:gae88cfb4b245c136f85f2403b4458ea52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga73ce65c9215066e78f0dd42ace00887a"><td class="memItemLeft" align="right" valign="top">JKQTCOMMON_LIB_EXPORT std::pair&lt; std::function&lt; double(double)&gt;, std::function&lt; double(double)&gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__jkqtptools__math__statistics__regression.html#ga73ce65c9215066e78f0dd42ace00887a">jkqtpStatGenerateTransformation</a> (<a class="el" href="group__jkqtptools__math__statistics__regression.html#gaa798f2573e7f03cb328b15ff76dda335">JKQTPStatRegressionModelType</a> type)</td></tr>
<tr class="memdesc:ga73ce65c9215066e78f0dd42ace00887a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates the transformation function for x-data (<code>result.first</code> ) and y-data (<code>result.second</code> ) for each regression model in JKQTPStatRegressionModelType in <em>type</em>.  <a href="group__jkqtptools__math__statistics__regression.html#ga73ce65c9215066e78f0dd42ace00887a">More...</a><br /></td></tr>
<tr class="separator:ga73ce65c9215066e78f0dd42ace00887a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf81a452c8e0798f6bb4b8764dd5a2f89"><td class="memTemplParams" colspan="2">template&lt;class InputItX , class InputItY &gt; </td></tr>
<tr class="memitem:gaf81a452c8e0798f6bb4b8764dd5a2f89"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__jkqtptools__math__statistics__regression.html#gaf81a452c8e0798f6bb4b8764dd5a2f89">jkqtpstatLinearRegression</a> (InputItX firstX, InputItX lastX, InputItY firstY, InputItY lastY, double &amp;coeffA, double &amp;coeffB, bool fixA=false, bool fixB=false)</td></tr>
<tr class="memdesc:gaf81a452c8e0798f6bb4b8764dd5a2f89"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculate the linear regression coefficients for a given data range <em>firstX</em> / <em>firstY</em> ... <em>lastX</em> / <em>lastY</em> where the model is <img class="formulaInl" alt="$ f(x)=a+b\cdot x $" src="form_129.png" width="109" height="18"/> So this function solves the least-squares optimization problem:  <a href="group__jkqtptools__math__statistics__regression.html#gaf81a452c8e0798f6bb4b8764dd5a2f89">More...</a><br /></td></tr>
<tr class="separator:gaf81a452c8e0798f6bb4b8764dd5a2f89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab5c23e5d003ffde1fbf9a089ea454659"><td class="memTemplParams" colspan="2">template&lt;class InputItX , class InputItY , class InputItW &gt; </td></tr>
<tr class="memitem:gab5c23e5d003ffde1fbf9a089ea454659"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__jkqtptools__math__statistics__regression.html#gab5c23e5d003ffde1fbf9a089ea454659">jkqtpstatLinearWeightedRegression</a> (InputItX firstX, InputItX lastX, InputItY firstY, InputItY lastY, InputItW firstW, InputItW lastW, double &amp;coeffA, double &amp;coeffB, bool fixA=false, bool fixB=false, std::function&lt; double(double)&gt; fWeightDataToWi=&amp;<a class="el" href="group__jkqtptools__math__basic.html#gaf65c45af31289372105c13b5970aa7a2">jkqtp_identity</a>&lt; double &gt;)</td></tr>
<tr class="memdesc:gab5c23e5d003ffde1fbf9a089ea454659"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculate the weighted linear regression coefficients for a given for a given data range <em>firstX</em> / <em>firstY</em> / <em>firstW</em> ... <em>lastX</em> / <em>lastY</em> / <em>lastW</em> where the model is <img class="formulaInl" alt="$ f(x)=a+b\cdot x $" src="form_129.png" width="109" height="18"/> So this function solves the least-squares optimization problem:  <a href="group__jkqtptools__math__statistics__regression.html#gab5c23e5d003ffde1fbf9a089ea454659">More...</a><br /></td></tr>
<tr class="separator:gab5c23e5d003ffde1fbf9a089ea454659"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga71e0e49a1e5aaba294f4b9f7b3f25201"><td class="memTemplParams" colspan="2">template&lt;class InputItX , class InputItY &gt; </td></tr>
<tr class="memitem:ga71e0e49a1e5aaba294f4b9f7b3f25201"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__jkqtptools__math__statistics__regression.html#ga71e0e49a1e5aaba294f4b9f7b3f25201">jkqtpstatRegression</a> (<a class="el" href="group__jkqtptools__math__statistics__regression.html#gaa798f2573e7f03cb328b15ff76dda335">JKQTPStatRegressionModelType</a> type, InputItX firstX, InputItX lastX, InputItY firstY, InputItY lastY, double &amp;coeffA, double &amp;coeffB, bool fixA=false, bool fixB=false)</td></tr>
<tr class="memdesc:ga71e0e49a1e5aaba294f4b9f7b3f25201"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculate the linear regression coefficients for a given data range <em>firstX</em> / <em>firstY</em> ... <em>lastX</em> / <em>lastY</em> where the model is defined by <em>type</em> So this function solves the least-squares optimization problem:  <a href="group__jkqtptools__math__statistics__regression.html#ga71e0e49a1e5aaba294f4b9f7b3f25201">More...</a><br /></td></tr>
<tr class="separator:ga71e0e49a1e5aaba294f4b9f7b3f25201"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4d5788af55f493f384915cf012980432"><td class="memItemLeft" align="right" valign="top">JKQTCOMMON_LIB_EXPORT QString&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__jkqtptools__math__statistics__regression.html#ga4d5788af55f493f384915cf012980432">jkqtpstatRegressionModel2Latex</a> (<a class="el" href="group__jkqtptools__math__statistics__regression.html#gaa798f2573e7f03cb328b15ff76dda335">JKQTPStatRegressionModelType</a> type, double a, double b)</td></tr>
<tr class="memdesc:ga4d5788af55f493f384915cf012980432"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates a LaTeX string for the models from JKQTPStatRegressionModelType in <em>type</em>.  <a href="group__jkqtptools__math__statistics__regression.html#ga4d5788af55f493f384915cf012980432">More...</a><br /></td></tr>
<tr class="separator:ga4d5788af55f493f384915cf012980432"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7da14476c0d4bc417ec104dbcc930bb6"><td class="memTemplParams" colspan="2">template&lt;class InputItX , class InputItY &gt; </td></tr>
<tr class="memitem:ga7da14476c0d4bc417ec104dbcc930bb6"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__jkqtptools__math__statistics__regression.html#ga7da14476c0d4bc417ec104dbcc930bb6">jkqtpstatRobustIRLSLinearRegression</a> (InputItX firstX, InputItX lastX, InputItY firstY, InputItY lastY, double &amp;coeffA, double &amp;coeffB, bool fixA=false, bool fixB=false, double p=1.1, int iterations=100)</td></tr>
<tr class="memdesc:ga7da14476c0d4bc417ec104dbcc930bb6"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculate the (robust) iteratively reweighted least-squares (IRLS) estimate for the parameters of the model <img class="formulaInl" alt="$ f(x)=a+b\cdot x $" src="form_129.png" width="109" height="18"/> for a given data range <em>firstX</em> / <em>firstY</em> ... <em>lastX</em> / <em>lastY</em> So this function finds an outlier-robust solution to the optimization problem:  <a href="group__jkqtptools__math__statistics__regression.html#ga7da14476c0d4bc417ec104dbcc930bb6">More...</a><br /></td></tr>
<tr class="separator:ga7da14476c0d4bc417ec104dbcc930bb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3907535ce3b98a3b0a4898d9eee1443f"><td class="memTemplParams" colspan="2">template&lt;class InputItX , class InputItY &gt; </td></tr>
<tr class="memitem:ga3907535ce3b98a3b0a4898d9eee1443f"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__jkqtptools__math__statistics__regression.html#ga3907535ce3b98a3b0a4898d9eee1443f">jkqtpstatRobustIRLSRegression</a> (<a class="el" href="group__jkqtptools__math__statistics__regression.html#gaa798f2573e7f03cb328b15ff76dda335">JKQTPStatRegressionModelType</a> type, InputItX firstX, InputItX lastX, InputItY firstY, InputItY lastY, double &amp;coeffA, double &amp;coeffB, bool fixA=false, bool fixB=false, double p=1.1, int iterations=100)</td></tr>
<tr class="memdesc:ga3907535ce3b98a3b0a4898d9eee1443f"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculate the robust linear regression coefficients for a given data range <em>firstX</em> / <em>firstY</em> ... <em>lastX</em> / <em>lastY</em> where the model is defined by <em>type</em> So this function solves the Lp-norm optimization problem:  <a href="group__jkqtptools__math__statistics__regression.html#ga3907535ce3b98a3b0a4898d9eee1443f">More...</a><br /></td></tr>
<tr class="separator:ga3907535ce3b98a3b0a4898d9eee1443f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf06c7da956ec353a2ce4de010f83a777"><td class="memTemplParams" colspan="2">template&lt;class InputItX , class InputItY &gt; </td></tr>
<tr class="memitem:gaf06c7da956ec353a2ce4de010f83a777"><td class="memTemplItemLeft" align="right" valign="top">double&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__jkqtptools__math__statistics__regression.html#gaf06c7da956ec353a2ce4de010f83a777">jkqtpstatSumOfDeviations</a> (InputItX firstX, InputItX lastX, InputItY firstY, InputItY lastY, std::function&lt; double(double)&gt; f)</td></tr>
<tr class="memdesc:gaf06c7da956ec353a2ce4de010f83a777"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculates the sum of deviations <img class="formulaInl" alt="$ \chi^2 $" src="form_173.png" width="18" height="18"/> for a set of measurements <img class="formulaInl" alt="$ (x_i,y_i) $" src="form_122.png" width="47" height="18"/> with a fit function <img class="formulaInl" alt="$ f(x) $" src="form_88.png" width="31" height="18"/>  <a href="group__jkqtptools__math__statistics__regression.html#gaf06c7da956ec353a2ce4de010f83a777">More...</a><br /></td></tr>
<tr class="separator:gaf06c7da956ec353a2ce4de010f83a777"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga044f7aba2b1b1bd4bc252d92f11f995b"><td class="memTemplParams" colspan="2">template&lt;class InputItX , class InputItY , class InputItW &gt; </td></tr>
<tr class="memitem:ga044f7aba2b1b1bd4bc252d92f11f995b"><td class="memTemplItemLeft" align="right" valign="top">double&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__jkqtptools__math__statistics__regression.html#ga044f7aba2b1b1bd4bc252d92f11f995b">jkqtpstatWeightedCoefficientOfDetermination</a> (InputItX firstX, InputItX lastX, InputItY firstY, InputItY lastY, InputItW firstW, InputItW lastW, std::function&lt; double(double)&gt; f, std::function&lt; double(double)&gt; fWeightDataToWi=&amp;<a class="el" href="group__jkqtptools__math__basic.html#gaf65c45af31289372105c13b5970aa7a2">jkqtp_identity</a>&lt; double &gt;)</td></tr>
<tr class="memdesc:ga044f7aba2b1b1bd4bc252d92f11f995b"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculates the weightedcoefficient of determination <img class="formulaInl" alt="$ R^2 $" src="form_166.png" width="18" height="15"/> for a set of measurements <img class="formulaInl" alt="$ (x_i,y_i,w_i) $" src="form_169.png" width="70" height="18"/> with a fit function <img class="formulaInl" alt="$ f(x) $" src="form_88.png" width="31" height="18"/>  <a href="group__jkqtptools__math__statistics__regression.html#ga044f7aba2b1b1bd4bc252d92f11f995b">More...</a><br /></td></tr>
<tr class="separator:ga044f7aba2b1b1bd4bc252d92f11f995b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa6abec21468e0c369200d7fc92589531"><td class="memTemplParams" colspan="2">template&lt;class InputItX , class InputItY , class InputItW &gt; </td></tr>
<tr class="memitem:gaa6abec21468e0c369200d7fc92589531"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__jkqtptools__math__statistics__regression.html#gaa6abec21468e0c369200d7fc92589531">jkqtpstatWeightedRegression</a> (<a class="el" href="group__jkqtptools__math__statistics__regression.html#gaa798f2573e7f03cb328b15ff76dda335">JKQTPStatRegressionModelType</a> type, InputItX firstX, InputItX lastX, InputItY firstY, InputItY lastY, InputItW firstW, InputItW lastW, double &amp;coeffA, double &amp;coeffB, bool fixA=false, bool fixB=false, std::function&lt; double(double)&gt; fWeightDataToWi=&amp;<a class="el" href="group__jkqtptools__math__basic.html#gaf65c45af31289372105c13b5970aa7a2">jkqtp_identity</a>&lt; double &gt;)</td></tr>
<tr class="memdesc:gaa6abec21468e0c369200d7fc92589531"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculate the robust linear regression coefficients for a given data range <em>firstX</em> / <em>firstY</em> ... <em>lastX</em> / <em>lastY</em> where the model is defined by <em>type</em> So this function solves the Lp-norm optimization problem:  <a href="group__jkqtptools__math__statistics__regression.html#gaa6abec21468e0c369200d7fc92589531">More...</a><br /></td></tr>
<tr class="separator:gaa6abec21468e0c369200d7fc92589531"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga779070dee90458063383566992c0138a"><td class="memTemplParams" colspan="2">template&lt;class InputItX , class InputItY , class InputItW &gt; </td></tr>
<tr class="memitem:ga779070dee90458063383566992c0138a"><td class="memTemplItemLeft" align="right" valign="top">double&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__jkqtptools__math__statistics__regression.html#ga779070dee90458063383566992c0138a">jkqtpstatWeightedSumOfDeviations</a> (InputItX firstX, InputItX lastX, InputItY firstY, InputItY lastY, InputItW firstW, InputItW lastW, std::function&lt; double(double)&gt; f, std::function&lt; double(double)&gt; fWeightDataToWi=&amp;<a class="el" href="group__jkqtptools__math__basic.html#gaf65c45af31289372105c13b5970aa7a2">jkqtp_identity</a>&lt; double &gt;)</td></tr>
<tr class="memdesc:ga779070dee90458063383566992c0138a"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculates the weighted sum of deviations <img class="formulaInl" alt="$ \chi^2 $" src="form_173.png" width="18" height="18"/> for a set of measurements <img class="formulaInl" alt="$ (x_i,y_i,w_i) $" src="form_169.png" width="70" height="18"/> with a fit function <img class="formulaInl" alt="$ f(x) $" src="form_88.png" width="31" height="18"/>  <a href="group__jkqtptools__math__statistics__regression.html#ga779070dee90458063383566992c0138a">More...</a><br /></td></tr>
<tr class="separator:ga779070dee90458063383566992c0138a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="gaa798f2573e7f03cb328b15ff76dda335"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa798f2573e7f03cb328b15ff76dda335">&#9670;&nbsp;</a></span>JKQTPStatRegressionModelType</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__jkqtptools__math__statistics__regression.html#gaa798f2573e7f03cb328b15ff76dda335">JKQTPStatRegressionModelType</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">strong</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>when performing linear regression, different target functions can be fitted, if the input data is transformed accordingly. This library provides the options in this enum by default. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="ggaa798f2573e7f03cb328b15ff76dda335a32a843da6ea40ab3b17a3421ccdf671b"></a>Linear&#160;</td><td class="fielddoc"><p>linear model <img class="formulaInl" alt="$ f(x)=a+b\cdot x $" src="form_129.png" width="109" height="18"/> </p>
</td></tr>
<tr><td class="fieldname"><a id="ggaa798f2573e7f03cb328b15ff76dda335a0421fde669f1f6a68f34f112af7c8809"></a>PowerLaw&#160;</td><td class="fielddoc"><p>power law model <img class="formulaInl" alt="$ f(x)=a\cdot x^b $" src="form_176.png" width="88" height="20"/> </p>
</td></tr>
<tr><td class="fieldname"><a id="ggaa798f2573e7f03cb328b15ff76dda335ac1e19c09f700938f0ff7f1fd4722a3ac"></a>Exponential&#160;</td><td class="fielddoc"><p>exponential model <img class="formulaInl" alt="$ f(x)=a\cdot \exp(b\cdot x) $" src="form_177.png" width="137" height="18"/> </p>
</td></tr>
<tr><td class="fieldname"><a id="ggaa798f2573e7f03cb328b15ff76dda335a1e62c0f2dbc49df5365500269be663e0"></a>Logarithm&#160;</td><td class="fielddoc"><p>exponential model <img class="formulaInl" alt="$ f(x)=a+b\cdot \ln(x) $" src="form_178.png" width="133" height="18"/> </p>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="gaa01b3052e689312965761795abcdea4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa01b3052e689312965761795abcdea4b">&#9670;&nbsp;</a></span>jkqtpstatCoefficientOfDetermination()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class InputItX , class InputItY &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double jkqtpstatCoefficientOfDetermination </td>
          <td>(</td>
          <td class="paramtype">InputItX&#160;</td>
          <td class="paramname"><em>firstX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">InputItX&#160;</td>
          <td class="paramname"><em>lastX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">InputItY&#160;</td>
          <td class="paramname"><em>firstY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">InputItY&#160;</td>
          <td class="paramname"><em>lastY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::function&lt; double(double)&gt;&#160;</td>
          <td class="paramname"><em>f</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>calculates the coefficient of determination <img class="formulaInl" alt="$ R^2 $" src="form_166.png" width="18" height="15"/> for a set of measurements <img class="formulaInl" alt="$ (x_i,y_i) $" src="form_122.png" width="47" height="18"/> with a fit function <img class="formulaInl" alt="$ f(x) $" src="form_88.png" width="31" height="18"/> </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">InputItX</td><td>standard iterator type of <em>firstX</em> and <em>lastX</em>. </td></tr>
    <tr><td class="paramname">InputItY</td><td>standard iterator type of <em>firstY</em> and <em>lastY</em>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">firstX</td><td>iterator pointing to the first item in the x-dataset to use <img class="formulaInl" alt="$ x_1 $" src="form_123.png" width="16" height="11"/> </td></tr>
    <tr><td class="paramname">lastX</td><td>iterator pointing behind the last item in the x-dataset to use <img class="formulaInl" alt="$ x_N $" src="form_124.png" width="21" height="11"/> </td></tr>
    <tr><td class="paramname">firstY</td><td>iterator pointing to the first item in the y-dataset to use <img class="formulaInl" alt="$ y_1 $" src="form_125.png" width="15" height="11"/> </td></tr>
    <tr><td class="paramname">lastY</td><td>iterator pointing behind the last item in the y-dataset to use <img class="formulaInl" alt="$ y_N $" src="form_126.png" width="21" height="11"/> </td></tr>
    <tr><td class="paramname">f</td><td>function <img class="formulaInl" alt="$ f(x) $" src="form_88.png" width="31" height="18"/>, result of a fit to the data </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>coeffcicient of determination <p class="formulaDsp">
<img class="formulaDsp" alt="\[ R^2=1-\frac{\sum_i\bigl[y_i-f(x_i)\bigr]^2}{\sum_i\bigl[y_i-\overline{y}\bigr]^2} \]" src="form_167.png" width="185" height="52"/>
</p>
 where <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \overline{y}=\frac{1}{N}\cdot\sum_iy_i \]" src="form_168.png" width="101" height="42"/>
</p>
</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a href="https://en.wikipedia.org/wiki/Coefficient_of_determination">https://en.wikipedia.org/wiki/Coefficient_of_determination</a> </dd></dl>

</div>
</div>
<a id="ga6f80dbd6d93295db2cd71bb231546ce3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6f80dbd6d93295db2cd71bb231546ce3">&#9670;&nbsp;</a></span>jkqtpStatGenerateParameterATransformation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">JKQTCOMMON_LIB_EXPORT std::pair&lt;std::function&lt;double(double)&gt;,std::function&lt;double(double)&gt; &gt; jkqtpStatGenerateParameterATransformation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__jkqtptools__math__statistics__regression.html#gaa798f2573e7f03cb328b15ff76dda335">JKQTPStatRegressionModelType</a>&#160;</td>
          <td class="paramname"><em>type</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates the transformation function for a-parameter (offset, <code>result.first</code> : transform, <code>result.second</code> : back-transform) for each regression model in JKQTPStatRegressionModelType in <em>type</em>. </p>

</div>
</div>
<a id="ga6606355626d9d9973c867a68c9bfeac4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6606355626d9d9973c867a68c9bfeac4">&#9670;&nbsp;</a></span>jkqtpStatGenerateParameterBTransformation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">JKQTCOMMON_LIB_EXPORT std::pair&lt;std::function&lt;double(double)&gt;,std::function&lt;double(double)&gt; &gt; jkqtpStatGenerateParameterBTransformation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__jkqtptools__math__statistics__regression.html#gaa798f2573e7f03cb328b15ff76dda335">JKQTPStatRegressionModelType</a>&#160;</td>
          <td class="paramname"><em>type</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates the transformation function for b-parameter (slope, <code>result.first</code> : transform, <code>result.second</code> : back-transform) for each regression model in JKQTPStatRegressionModelType in <em>type</em>. </p>

</div>
</div>
<a id="ga4d8e68bdb86c24be6ef6595135697988"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4d8e68bdb86c24be6ef6595135697988">&#9670;&nbsp;</a></span>jkqtpStatGenerateRegressionModel() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">JKQTCOMMON_LIB_EXPORT std::function&lt;double(double, double, double)&gt; jkqtpStatGenerateRegressionModel </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__jkqtptools__math__statistics__regression.html#gaa798f2573e7f03cb328b15ff76dda335">JKQTPStatRegressionModelType</a>&#160;</td>
          <td class="paramname"><em>type</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates functors <code>f(x,a,b)</code> for the models from JKQTPStatRegressionModelType in <em>type</em>. </p>

</div>
</div>
<a id="gae88cfb4b245c136f85f2403b4458ea52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae88cfb4b245c136f85f2403b4458ea52">&#9670;&nbsp;</a></span>jkqtpStatGenerateRegressionModel() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">JKQTCOMMON_LIB_EXPORT std::function&lt;double(double)&gt; jkqtpStatGenerateRegressionModel </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__jkqtptools__math__statistics__regression.html#gaa798f2573e7f03cb328b15ff76dda335">JKQTPStatRegressionModelType</a>&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates functors <code>f(x)</code> for the models from JKQTPStatRegressionModelType in <em>type</em> and binds the parameter values <em>and</em> <em>b</em> to the returned function. </p>

</div>
</div>
<a id="ga73ce65c9215066e78f0dd42ace00887a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga73ce65c9215066e78f0dd42ace00887a">&#9670;&nbsp;</a></span>jkqtpStatGenerateTransformation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">JKQTCOMMON_LIB_EXPORT std::pair&lt;std::function&lt;double(double)&gt;,std::function&lt;double(double)&gt; &gt; jkqtpStatGenerateTransformation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__jkqtptools__math__statistics__regression.html#gaa798f2573e7f03cb328b15ff76dda335">JKQTPStatRegressionModelType</a>&#160;</td>
          <td class="paramname"><em>type</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates the transformation function for x-data (<code>result.first</code> ) and y-data (<code>result.second</code> ) for each regression model in JKQTPStatRegressionModelType in <em>type</em>. </p>

</div>
</div>
<a id="gaf81a452c8e0798f6bb4b8764dd5a2f89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf81a452c8e0798f6bb4b8764dd5a2f89">&#9670;&nbsp;</a></span>jkqtpstatLinearRegression()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class InputItX , class InputItY &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void jkqtpstatLinearRegression </td>
          <td>(</td>
          <td class="paramtype">InputItX&#160;</td>
          <td class="paramname"><em>firstX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">InputItX&#160;</td>
          <td class="paramname"><em>lastX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">InputItY&#160;</td>
          <td class="paramname"><em>firstY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">InputItY&#160;</td>
          <td class="paramname"><em>lastY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>coeffA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>coeffB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>fixA</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>fixB</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>calculate the linear regression coefficients for a given data range <em>firstX</em> / <em>firstY</em> ... <em>lastX</em> / <em>lastY</em> where the model is <img class="formulaInl" alt="$ f(x)=a+b\cdot x $" src="form_129.png" width="109" height="18"/> So this function solves the least-squares optimization problem: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ (a^\ast, b^\ast)=\mathop{\mathrm{arg\;min}}\limits_{a,b}\sum\limits_i\left(y_i-(a+b\cdot x_i)\right)^2 \]" src="form_130.png" width="281" height="36"/>
</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">InputItX</td><td>standard iterator type of <em>firstX</em> and <em>lastX</em>. </td></tr>
    <tr><td class="paramname">InputItY</td><td>standard iterator type of <em>firstY</em> and <em>lastY</em>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">firstX</td><td>iterator pointing to the first item in the x-dataset to use <img class="formulaInl" alt="$ x_1 $" src="form_123.png" width="16" height="11"/> </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">lastX</td><td>iterator pointing behind the last item in the x-dataset to use <img class="formulaInl" alt="$ x_N $" src="form_124.png" width="21" height="11"/> </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">firstY</td><td>iterator pointing to the first item in the y-dataset to use <img class="formulaInl" alt="$ y_1 $" src="form_125.png" width="15" height="11"/> </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">lastY</td><td>iterator pointing behind the last item in the y-dataset to use <img class="formulaInl" alt="$ y_N $" src="form_126.png" width="21" height="11"/> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">coeffA</td><td>returns the offset of the linear model </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">coeffB</td><td>returns the slope of the linear model </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">fixA</td><td>if <code>true</code>, the offset coefficient <img class="formulaInl" alt="$ a $" src="form_131.png" width="8" height="8"/> is not determined by the fit, but the value provided in <em>coeffA</em> is used </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">fixB</td><td>if <code>true</code>, the slope coefficient <img class="formulaInl" alt="$ b $" src="form_132.png" width="7" height="13"/> is not determined by the fit, but the value provided in <em>coeffB</em> is used</td></tr>
  </table>
  </dd>
</dl>
<p>This function computes internally: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ a=\overline{y}-b\cdot\overline{x} \]" src="form_133.png" width="88" height="16"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ b=\frac{\sum x_iy_i-N\cdot\overline{x}\cdot\overline{y}}{\sum x_i^2-N\cdot(\overline{x})^2} \]" src="form_134.png" width="154" height="41"/>
</p>
<div class="image">
<img src="datastore_regression_lin.png" alt=""/>
</div>
 
</div>
</div>
<a id="gab5c23e5d003ffde1fbf9a089ea454659"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab5c23e5d003ffde1fbf9a089ea454659">&#9670;&nbsp;</a></span>jkqtpstatLinearWeightedRegression()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class InputItX , class InputItY , class InputItW &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void jkqtpstatLinearWeightedRegression </td>
          <td>(</td>
          <td class="paramtype">InputItX&#160;</td>
          <td class="paramname"><em>firstX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">InputItX&#160;</td>
          <td class="paramname"><em>lastX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">InputItY&#160;</td>
          <td class="paramname"><em>firstY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">InputItY&#160;</td>
          <td class="paramname"><em>lastY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">InputItW&#160;</td>
          <td class="paramname"><em>firstW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">InputItW&#160;</td>
          <td class="paramname"><em>lastW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>coeffA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>coeffB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>fixA</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>fixB</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::function&lt; double(double)&gt;&#160;</td>
          <td class="paramname"><em>fWeightDataToWi</em> = <code>&amp;<a class="el" href="group__jkqtptools__math__basic.html#gaf65c45af31289372105c13b5970aa7a2">jkqtp_identity</a>&lt;double&gt;</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>calculate the weighted linear regression coefficients for a given for a given data range <em>firstX</em> / <em>firstY</em> / <em>firstW</em> ... <em>lastX</em> / <em>lastY</em> / <em>lastW</em> where the model is <img class="formulaInl" alt="$ f(x)=a+b\cdot x $" src="form_129.png" width="109" height="18"/> So this function solves the least-squares optimization problem: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ (a^\ast, b^\ast)=\mathop{\mathrm{arg\;min}}\limits_{a,b}\sum\limits_iw_i^2\cdot\left(y_i-(a+b\cdot x_i)\right)^2 \]" src="form_135.png" width="310" height="36"/>
</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">InputItX</td><td>standard iterator type of <em>firstX</em> and <em>lastX</em>. </td></tr>
    <tr><td class="paramname">InputItY</td><td>standard iterator type of <em>firstY</em> and <em>lastY</em>. </td></tr>
    <tr><td class="paramname">InputItW</td><td>standard iterator type of <em>firstW</em> and <em>lastW</em>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">firstX</td><td>iterator pointing to the first item in the x-dataset to use <img class="formulaInl" alt="$ x_1 $" src="form_123.png" width="16" height="11"/> </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">lastX</td><td>iterator pointing behind the last item in the x-dataset to use <img class="formulaInl" alt="$ x_N $" src="form_124.png" width="21" height="11"/> </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">firstY</td><td>iterator pointing to the first item in the y-dataset to use <img class="formulaInl" alt="$ y_1 $" src="form_125.png" width="15" height="11"/> </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">lastY</td><td>iterator pointing behind the last item in the y-dataset to use <img class="formulaInl" alt="$ y_N $" src="form_126.png" width="21" height="11"/> </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">firstW</td><td>iterator pointing to the first item in the weight-dataset to use <img class="formulaInl" alt="$ w_1 $" src="form_136.png" width="20" height="11"/> </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">lastW</td><td>iterator pointing behind the last item in the weight-dataset to use <img class="formulaInl" alt="$ w_N $" src="form_137.png" width="24" height="11"/> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">coeffA</td><td>returns the offset of the linear model </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">coeffB</td><td>returns the slope of the linear model </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">fixA</td><td>if <code>true</code>, the offset coefficient <img class="formulaInl" alt="$ a $" src="form_131.png" width="8" height="8"/> is not determined by the fit, but the value provided in <em>coeffA</em> is used </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">fixB</td><td>if <code>true</code>, the slope coefficient <img class="formulaInl" alt="$ b $" src="form_132.png" width="7" height="13"/> is not determined by the fit, but the value provided in <em>coeffB</em> is used </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">fWeightDataToWi</td><td>an optional function, which is applied to the data from <em>firstW</em> ... <em>lastW</em> to convert them to weight, i.e. <code>wi=fWeightDataToWi(*itW)</code> e.g. if you use data used to draw error bars, you can use <a class="el" href="group__jkqtptools__math__basic.html#gaecfd3a8f48b514e8ce878d0b6a3ff488" title="returns the inversely proportional value 1/v of v and ensures that , uses absMinV=std::numeric_limits...">jkqtp_inversePropSaveDefault()</a>. The default is <a class="el" href="group__jkqtptools__math__basic.html#gaf65c45af31289372105c13b5970aa7a2" title="returns the given value v (i.e. identity function)">jkqtp_identity()</a>, which just returns the values. In the case of <a class="el" href="group__jkqtptools__math__basic.html#gaecfd3a8f48b514e8ce878d0b6a3ff488" title="returns the inversely proportional value 1/v of v and ensures that , uses absMinV=std::numeric_limits...">jkqtp_inversePropSaveDefault()</a>, a datapoint x,y, has a large weight, if it's error is small and in the case if <a class="el" href="group__jkqtptools__math__basic.html#gaf65c45af31289372105c13b5970aa7a2" title="returns the given value v (i.e. identity function)">jkqtp_identity()</a> it's weight is directly proportional to the given value.</td></tr>
  </table>
  </dd>
</dl>
<p>This function internally computes: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ a=\frac{\overline{y}-b\cdot\overline{x}}{\overline{w^2}} \]" src="form_138.png" width="89" height="37"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ b=\frac{\overline{w^2}\cdot\overline{x\cdot y}-\overline{x}\cdot\overline{y}}{\overline{x^2}\cdot\overline{w^2}-\overline{x}^2} \]" src="form_139.png" width="141" height="41"/>
</p>
<p>Here the averages are defined in terms of a weight vector <img class="formulaInl" alt="$ w_i$" src="form_140.png" width="18" height="11"/>: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \overline{x}=\sum\limits_iw_i^2\cdot x_i \]" src="form_141.png" width="102" height="36"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \overline{y}=\sum\limits_iw_i^2\cdot y_i \]" src="form_142.png" width="101" height="36"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \overline{x\cdot y}=\sum\limits_iw_i^2\cdot x_i\cdot y_i \]" src="form_143.png" width="148" height="36"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \overline{x^2}=\sum\limits_iw_i^2\cdot x_i^2 \]" src="form_144.png" width="112" height="36"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \overline{w^2}=\sum\limits_iw_i^2 \]" src="form_145.png" width="86" height="36"/>
</p>
<div class="image">
<img src="datastore_regression_linweight.png" alt=""/>
</div>
 
</div>
</div>
<a id="ga71e0e49a1e5aaba294f4b9f7b3f25201"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga71e0e49a1e5aaba294f4b9f7b3f25201">&#9670;&nbsp;</a></span>jkqtpstatRegression()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class InputItX , class InputItY &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void jkqtpstatRegression </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__jkqtptools__math__statistics__regression.html#gaa798f2573e7f03cb328b15ff76dda335">JKQTPStatRegressionModelType</a>&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">InputItX&#160;</td>
          <td class="paramname"><em>firstX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">InputItX&#160;</td>
          <td class="paramname"><em>lastX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">InputItY&#160;</td>
          <td class="paramname"><em>firstY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">InputItY&#160;</td>
          <td class="paramname"><em>lastY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>coeffA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>coeffB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>fixA</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>fixB</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>calculate the linear regression coefficients for a given data range <em>firstX</em> / <em>firstY</em> ... <em>lastX</em> / <em>lastY</em> where the model is defined by <em>type</em> So this function solves the least-squares optimization problem: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ (a^\ast, b^\ast)=\mathop{\mathrm{arg\;min}}\limits_{a,b}\sum\limits_i\left(y_i-f_{\text{type}}(x_i,a,b)\right)^2 \]" src="form_163.png" width="297" height="36"/>
</p>
<p> by reducing it to a linear fit by transforming x- and/or y-data</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">InputItX</td><td>standard iterator type of <em>firstX</em> and <em>lastX</em>. </td></tr>
    <tr><td class="paramname">InputItY</td><td>standard iterator type of <em>firstY</em> and <em>lastY</em>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">type</td><td>model to be fitted </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">firstX</td><td>iterator pointing to the first item in the x-dataset to use <img class="formulaInl" alt="$ x_1 $" src="form_123.png" width="16" height="11"/> </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">lastX</td><td>iterator pointing behind the last item in the x-dataset to use <img class="formulaInl" alt="$ x_N $" src="form_124.png" width="21" height="11"/> </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">firstY</td><td>iterator pointing to the first item in the y-dataset to use <img class="formulaInl" alt="$ y_1 $" src="form_125.png" width="15" height="11"/> </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">lastY</td><td>iterator pointing behind the last item in the y-dataset to use <img class="formulaInl" alt="$ y_N $" src="form_126.png" width="21" height="11"/> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">coeffA</td><td>returns the offset of the linear model </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">coeffB</td><td>returns the slope of the linear model </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">fixA</td><td>if <code>true</code>, the offset coefficient <img class="formulaInl" alt="$ a $" src="form_131.png" width="8" height="8"/> is not determined by the fit, but the value provided in <em>coeffA</em> is used </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">fixB</td><td>if <code>true</code>, the slope coefficient <img class="formulaInl" alt="$ b $" src="form_132.png" width="7" height="13"/> is not determined by the fit, but the value provided in <em>coeffB</em> is used</td></tr>
  </table>
  </dd>
</dl>
<p>This function computes internally first transforms the data, as appropriate to fit the model defined by <em>type</em> and then calls <a class="el" href="group__jkqtptools__math__statistics__regression.html#gaf81a452c8e0798f6bb4b8764dd5a2f89" title="calculate the linear regression coefficients for a given data range firstX / firstY ....">jkqtpstatLinearRegression()</a> to obtain the parameters. The output parameters are transformed, so they can be used with <a class="el" href="group__jkqtptools__math__statistics__regression.html#ga4d8e68bdb86c24be6ef6595135697988" title="Generates functors f(x,a,b) for the models from JKQTPStatRegressionModelType in type.">jkqtpStatGenerateRegressionModel()</a> to generate a functor that evaluates the model</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__jkqtptools__math__statistics__regression.html#gaa798f2573e7f03cb328b15ff76dda335" title="when performing linear regression, different target functions can be fitted, if the input data is tra...">JKQTPStatRegressionModelType</a>, <a class="el" href="group__jkqtptools__math__statistics__regression.html#ga4d8e68bdb86c24be6ef6595135697988" title="Generates functors f(x,a,b) for the models from JKQTPStatRegressionModelType in type.">jkqtpStatGenerateRegressionModel()</a>, <a class="el" href="group__jkqtptools__math__statistics__regression.html#gaf81a452c8e0798f6bb4b8764dd5a2f89" title="calculate the linear regression coefficients for a given data range firstX / firstY ....">jkqtpstatLinearRegression()</a>, <a class="el" href="group__jkqtptools__math__statistics__regression.html#ga73ce65c9215066e78f0dd42ace00887a" title="Generates the transformation function for x-data (result.first ) and y-data (result....">jkqtpStatGenerateTransformation()</a> </dd></dl>

</div>
</div>
<a id="ga4d5788af55f493f384915cf012980432"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4d5788af55f493f384915cf012980432">&#9670;&nbsp;</a></span>jkqtpstatRegressionModel2Latex()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">JKQTCOMMON_LIB_EXPORT QString jkqtpstatRegressionModel2Latex </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__jkqtptools__math__statistics__regression.html#gaa798f2573e7f03cb328b15ff76dda335">JKQTPStatRegressionModelType</a>&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates a LaTeX string for the models from JKQTPStatRegressionModelType in <em>type</em>. </p>

</div>
</div>
<a id="ga7da14476c0d4bc417ec104dbcc930bb6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7da14476c0d4bc417ec104dbcc930bb6">&#9670;&nbsp;</a></span>jkqtpstatRobustIRLSLinearRegression()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class InputItX , class InputItY &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void jkqtpstatRobustIRLSLinearRegression </td>
          <td>(</td>
          <td class="paramtype">InputItX&#160;</td>
          <td class="paramname"><em>firstX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">InputItX&#160;</td>
          <td class="paramname"><em>lastX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">InputItY&#160;</td>
          <td class="paramname"><em>firstY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">InputItY&#160;</td>
          <td class="paramname"><em>lastY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>coeffA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>coeffB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>fixA</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>fixB</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>p</em> = <code>1.1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iterations</em> = <code>100</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>calculate the (robust) iteratively reweighted least-squares (IRLS) estimate for the parameters of the model <img class="formulaInl" alt="$ f(x)=a+b\cdot x $" src="form_129.png" width="109" height="18"/> for a given data range <em>firstX</em> / <em>firstY</em> ... <em>lastX</em> / <em>lastY</em> So this function finds an outlier-robust solution to the optimization problem: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ (a^\ast,b^\ast)=\mathop{\mathrm{arg\;min}}\limits_{a,b}\sum\limits_i|a+b\cdot x_i-y_i|^p \]" src="form_146.png" width="265" height="36"/>
</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">InputItX</td><td>standard iterator type of <em>firstX</em> and <em>lastX</em>. </td></tr>
    <tr><td class="paramname">InputItY</td><td>standard iterator type of <em>firstY</em> and <em>lastY</em>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">firstX</td><td>iterator pointing to the first item in the x-dataset to use <img class="formulaInl" alt="$ x_1 $" src="form_123.png" width="16" height="11"/> </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">lastX</td><td>iterator pointing behind the last item in the x-dataset to use <img class="formulaInl" alt="$ x_N $" src="form_124.png" width="21" height="11"/> </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">firstY</td><td>iterator pointing to the first item in the y-dataset to use <img class="formulaInl" alt="$ y_1 $" src="form_125.png" width="15" height="11"/> </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">lastY</td><td>iterator pointing behind the last item in the y-dataset to use <img class="formulaInl" alt="$ y_N $" src="form_126.png" width="21" height="11"/> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">coeffA</td><td>returns the offset of the linear model </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">coeffB</td><td>returns the slope of the linear model </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">fixA</td><td>if <code>true</code>, the offset coefficient <img class="formulaInl" alt="$ a $" src="form_131.png" width="8" height="8"/> is not determined by the fit, but the value provided in <em>coeffA</em> is used </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">fixB</td><td>if <code>true</code>, the slope coefficient <img class="formulaInl" alt="$ b $" src="form_132.png" width="7" height="13"/> is not determined by the fit, but the value provided in <em>coeffB</em> is used </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">p</td><td>regularization parameter, the optimization problem is formulated in the <img class="formulaInl" alt="$ L_p $" src="form_147.png" width="18" height="18"/> norm, using this <em>p</em> (see image below for an example) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">iterations</td><td>the number of iterations the IRLS algorithm performs</td></tr>
  </table>
  </dd>
</dl>
<p>This is a simple form of the IRLS algorithm to estimate the parameters a and b in a linear model <img class="formulaInl" alt="$ f(x)=a+b\cdot x $" src="form_129.png" width="109" height="18"/>. This algorithm solves the optimization problem for a <img class="formulaInl" alt="$ L_p$" src="form_148.png" width="18" height="18"/>-norm: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ (a^\ast,b^\ast)=\mathop{\mathrm{arg\;min}}\limits_{a,b}\sum\limits_i|a+b\cdot x_i-y_i|^p \]" src="form_146.png" width="265" height="36"/>
</p>
<p> by iteratively optimization weights <img class="formulaInl" alt="$ \vec{w} $" src="form_149.png" width="15" height="13"/> and solving a weighted least squares problem in each iteration: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ (a_n,b_n)=\mathop{\mathrm{arg\;min}}\limits_{a,b}\sum\limits_i|a+b\cdot x_i-y_i|^{(p-2)}\cdot|a+b\cdot x_i-y_i|^2 \]" src="form_150.png" width="418" height="36"/>
</p>
<p>The IRLS-algorithm works as follows:</p><ul>
<li>calculate initial <img class="formulaInl" alt="$ a_0$" src="form_151.png" width="15" height="11"/> and <img class="formulaInl" alt="$ b_0$" src="form_152.png" width="13" height="16"/> with unweighted regression from x and y</li>
<li>perform a number of iterations (parameter <em>iterations</em> ). In each iteration <img class="formulaInl" alt="$ n$" src="form_153.png" width="11" height="8"/>:<ul>
<li>calculate the error vector <img class="formulaInl" alt="$\vec{e}$" src="form_154.png" width="10" height="13"/>: <p class="formulaDsp">
<img class="formulaDsp" alt="\[ e_i = a+b\cdot x_i -y_i \]" src="form_155.png" width="128" height="16"/>
</p>
</li>
<li>estimate new weights <img class="formulaInl" alt="$\vec{w}$" src="form_156.png" width="15" height="13"/>: <p class="formulaDsp">
<img class="formulaDsp" alt="\[ w_i=|e_i|^{(p-2)/2} \]" src="form_157.png" width="107" height="21"/>
</p>
</li>
<li>calculate new estimates <img class="formulaInl" alt="$ a_n$" src="form_158.png" width="16" height="11"/> and <img class="formulaInl" alt="$ b_n$" src="form_159.png" width="15" height="16"/> with weighted regression from <img class="formulaInl" alt="$ \vec{x}$" src="form_160.png" width="11" height="13"/> and <img class="formulaInl" alt="$ \vec{y}$" src="form_161.png" width="11" height="16"/> and <img class="formulaInl" alt="$ \vec{w}$" src="form_162.png" width="15" height="13"/></li>
</ul>
</li>
</ul>
<ul>
<li>return the last estimates <img class="formulaInl" alt="$ a_n$" src="form_158.png" width="16" height="11"/> and <img class="formulaInl" alt="$ b_n$" src="form_159.png" width="15" height="16"/></li>
</ul>
<div class="image">
<img src="irls.png" alt=""/>
</div>
<div class="image">
<img src="datastore_regression_linrobust_p.png" alt=""/>
</div>
<dl class="section see"><dt>See also</dt><dd><a href="https://en.wikipedia.org/wiki/Iteratively_reweighted_least_squares">https://en.wikipedia.org/wiki/Iteratively_reweighted_least_squares</a>, C. Sidney Burrus: "Iterative Reweighted Least Squares", <a href="http://cnx.org/content/m45285/latest/">http://cnx.org/content/m45285/latest/</a> </dd></dl>

</div>
</div>
<a id="ga3907535ce3b98a3b0a4898d9eee1443f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3907535ce3b98a3b0a4898d9eee1443f">&#9670;&nbsp;</a></span>jkqtpstatRobustIRLSRegression()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class InputItX , class InputItY &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void jkqtpstatRobustIRLSRegression </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__jkqtptools__math__statistics__regression.html#gaa798f2573e7f03cb328b15ff76dda335">JKQTPStatRegressionModelType</a>&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">InputItX&#160;</td>
          <td class="paramname"><em>firstX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">InputItX&#160;</td>
          <td class="paramname"><em>lastX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">InputItY&#160;</td>
          <td class="paramname"><em>firstY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">InputItY&#160;</td>
          <td class="paramname"><em>lastY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>coeffA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>coeffB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>fixA</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>fixB</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>p</em> = <code>1.1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iterations</em> = <code>100</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>calculate the robust linear regression coefficients for a given data range <em>firstX</em> / <em>firstY</em> ... <em>lastX</em> / <em>lastY</em> where the model is defined by <em>type</em> So this function solves the Lp-norm optimization problem: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ (a^\ast, b^\ast)=\mathop{\mathrm{arg\;min}}\limits_{a,b}\sum\limits_i|y_i-f_{\text{type}}(x_i,a,b)|^p \]" src="form_164.png" width="294" height="36"/>
</p>
<p> by reducing it to a linear fit by transforming x- and/or y-data</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">InputItX</td><td>standard iterator type of <em>firstX</em> and <em>lastX</em>. </td></tr>
    <tr><td class="paramname">InputItY</td><td>standard iterator type of <em>firstY</em> and <em>lastY</em>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">type</td><td>model to be fitted </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">firstX</td><td>iterator pointing to the first item in the x-dataset to use <img class="formulaInl" alt="$ x_1 $" src="form_123.png" width="16" height="11"/> </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">lastX</td><td>iterator pointing behind the last item in the x-dataset to use <img class="formulaInl" alt="$ x_N $" src="form_124.png" width="21" height="11"/> </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">firstY</td><td>iterator pointing to the first item in the y-dataset to use <img class="formulaInl" alt="$ y_1 $" src="form_125.png" width="15" height="11"/> </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">lastY</td><td>iterator pointing behind the last item in the y-dataset to use <img class="formulaInl" alt="$ y_N $" src="form_126.png" width="21" height="11"/> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">coeffA</td><td>returns the offset of the linear model </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">coeffB</td><td>returns the slope of the linear model </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">fixA</td><td>if <code>true</code>, the offset coefficient <img class="formulaInl" alt="$ a $" src="form_131.png" width="8" height="8"/> is not determined by the fit, but the value provided in <em>coeffA</em> is used </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">fixB</td><td>if <code>true</code>, the slope coefficient <img class="formulaInl" alt="$ b $" src="form_132.png" width="7" height="13"/> is not determined by the fit, but the value provided in <em>coeffB</em> is used </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">p</td><td>regularization parameter, the optimization problem is formulated in the <img class="formulaInl" alt="$ L_p $" src="form_147.png" width="18" height="18"/> norm, using this <em>p</em> (see image below for an example) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">iterations</td><td>the number of iterations the IRLS algorithm performs</td></tr>
  </table>
  </dd>
</dl>
<p>This function computes internally first transforms the data, as appropriate to fit the model defined by <em>type</em> and then calls <a class="el" href="group__jkqtptools__math__statistics__regression.html#ga7da14476c0d4bc417ec104dbcc930bb6" title="calculate the (robust) iteratively reweighted least-squares (IRLS) estimate for the parameters of the...">jkqtpstatRobustIRLSLinearRegression()</a> to obtain the parameters. The output parameters are transformed, so they can be used with <a class="el" href="group__jkqtptools__math__statistics__regression.html#ga4d8e68bdb86c24be6ef6595135697988" title="Generates functors f(x,a,b) for the models from JKQTPStatRegressionModelType in type.">jkqtpStatGenerateRegressionModel()</a> to generate a functor that evaluates the model</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__jkqtptools__math__statistics__regression.html#gaa798f2573e7f03cb328b15ff76dda335" title="when performing linear regression, different target functions can be fitted, if the input data is tra...">JKQTPStatRegressionModelType</a>, <a class="el" href="group__jkqtptools__math__statistics__regression.html#ga4d8e68bdb86c24be6ef6595135697988" title="Generates functors f(x,a,b) for the models from JKQTPStatRegressionModelType in type.">jkqtpStatGenerateRegressionModel()</a>, <a class="el" href="group__jkqtptools__math__statistics__regression.html#ga7da14476c0d4bc417ec104dbcc930bb6" title="calculate the (robust) iteratively reweighted least-squares (IRLS) estimate for the parameters of the...">jkqtpstatRobustIRLSLinearRegression()</a>, <a class="el" href="group__jkqtptools__math__statistics__regression.html#ga73ce65c9215066e78f0dd42ace00887a" title="Generates the transformation function for x-data (result.first ) and y-data (result....">jkqtpStatGenerateTransformation()</a> </dd></dl>

</div>
</div>
<a id="gaf06c7da956ec353a2ce4de010f83a777"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf06c7da956ec353a2ce4de010f83a777">&#9670;&nbsp;</a></span>jkqtpstatSumOfDeviations()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class InputItX , class InputItY &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double jkqtpstatSumOfDeviations </td>
          <td>(</td>
          <td class="paramtype">InputItX&#160;</td>
          <td class="paramname"><em>firstX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">InputItX&#160;</td>
          <td class="paramname"><em>lastX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">InputItY&#160;</td>
          <td class="paramname"><em>firstY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">InputItY&#160;</td>
          <td class="paramname"><em>lastY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::function&lt; double(double)&gt;&#160;</td>
          <td class="paramname"><em>f</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>calculates the sum of deviations <img class="formulaInl" alt="$ \chi^2 $" src="form_173.png" width="18" height="18"/> for a set of measurements <img class="formulaInl" alt="$ (x_i,y_i) $" src="form_122.png" width="47" height="18"/> with a fit function <img class="formulaInl" alt="$ f(x) $" src="form_88.png" width="31" height="18"/> </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">InputItX</td><td>standard iterator type of <em>firstX</em> and <em>lastX</em>. </td></tr>
    <tr><td class="paramname">InputItY</td><td>standard iterator type of <em>firstY</em> and <em>lastY</em>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">firstX</td><td>iterator pointing to the first item in the x-dataset to use <img class="formulaInl" alt="$ x_1 $" src="form_123.png" width="16" height="11"/> </td></tr>
    <tr><td class="paramname">lastX</td><td>iterator pointing behind the last item in the x-dataset to use <img class="formulaInl" alt="$ x_N $" src="form_124.png" width="21" height="11"/> </td></tr>
    <tr><td class="paramname">firstY</td><td>iterator pointing to the first item in the y-dataset to use <img class="formulaInl" alt="$ y_1 $" src="form_125.png" width="15" height="11"/> </td></tr>
    <tr><td class="paramname">lastY</td><td>iterator pointing behind the last item in the y-dataset to use <img class="formulaInl" alt="$ y_N $" src="form_126.png" width="21" height="11"/> </td></tr>
    <tr><td class="paramname">f</td><td>function <img class="formulaInl" alt="$ f(x) $" src="form_88.png" width="31" height="18"/>, result of a fit to the data </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>sum of deviations <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \chi^2=\sum_i\bigl[y_i-f(x_i)\bigr]^2 \]" src="form_174.png" width="153" height="37"/>
</p>
</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a href="https://en.wikipedia.org/wiki/Coefficient_of_determination">https://en.wikipedia.org/wiki/Coefficient_of_determination</a> </dd></dl>

</div>
</div>
<a id="ga044f7aba2b1b1bd4bc252d92f11f995b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga044f7aba2b1b1bd4bc252d92f11f995b">&#9670;&nbsp;</a></span>jkqtpstatWeightedCoefficientOfDetermination()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class InputItX , class InputItY , class InputItW &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double jkqtpstatWeightedCoefficientOfDetermination </td>
          <td>(</td>
          <td class="paramtype">InputItX&#160;</td>
          <td class="paramname"><em>firstX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">InputItX&#160;</td>
          <td class="paramname"><em>lastX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">InputItY&#160;</td>
          <td class="paramname"><em>firstY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">InputItY&#160;</td>
          <td class="paramname"><em>lastY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">InputItW&#160;</td>
          <td class="paramname"><em>firstW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">InputItW&#160;</td>
          <td class="paramname"><em>lastW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::function&lt; double(double)&gt;&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::function&lt; double(double)&gt;&#160;</td>
          <td class="paramname"><em>fWeightDataToWi</em> = <code>&amp;<a class="el" href="group__jkqtptools__math__basic.html#gaf65c45af31289372105c13b5970aa7a2">jkqtp_identity</a>&lt;double&gt;</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>calculates the weightedcoefficient of determination <img class="formulaInl" alt="$ R^2 $" src="form_166.png" width="18" height="15"/> for a set of measurements <img class="formulaInl" alt="$ (x_i,y_i,w_i) $" src="form_169.png" width="70" height="18"/> with a fit function <img class="formulaInl" alt="$ f(x) $" src="form_88.png" width="31" height="18"/> </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">InputItX</td><td>standard iterator type of <em>firstX</em> and <em>lastX</em>. </td></tr>
    <tr><td class="paramname">InputItY</td><td>standard iterator type of <em>firstY</em> and <em>lastY</em>. </td></tr>
    <tr><td class="paramname">InputItW</td><td>standard iterator type of <em>firstW</em> and <em>lastW</em>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">firstX</td><td>iterator pointing to the first item in the x-dataset to use <img class="formulaInl" alt="$ x_1 $" src="form_123.png" width="16" height="11"/> </td></tr>
    <tr><td class="paramname">lastX</td><td>iterator pointing behind the last item in the x-dataset to use <img class="formulaInl" alt="$ x_N $" src="form_124.png" width="21" height="11"/> </td></tr>
    <tr><td class="paramname">firstY</td><td>iterator pointing to the first item in the y-dataset to use <img class="formulaInl" alt="$ y_1 $" src="form_125.png" width="15" height="11"/> </td></tr>
    <tr><td class="paramname">lastY</td><td>iterator pointing behind the last item in the y-dataset to use <img class="formulaInl" alt="$ y_N $" src="form_126.png" width="21" height="11"/> </td></tr>
    <tr><td class="paramname">firstW</td><td>iterator pointing to the first item in the weight-dataset to use <img class="formulaInl" alt="$ w_1 $" src="form_136.png" width="20" height="11"/> </td></tr>
    <tr><td class="paramname">lastW</td><td>iterator pointing behind the last item in the weight-dataset to use <img class="formulaInl" alt="$ w_N $" src="form_137.png" width="24" height="11"/> </td></tr>
    <tr><td class="paramname">f</td><td>function <img class="formulaInl" alt="$ f(x) $" src="form_88.png" width="31" height="18"/>, result of a fit to the data </td></tr>
    <tr><td class="paramname">fWeightDataToWi</td><td>an optional function, which is applied to the data from <em>firstW</em> ... <em>lastW</em> to convert them to weight, i.e. <code>wi=fWeightDataToWi(*itW)</code> e.g. if you use data used to draw error bars, you can use <a class="el" href="group__jkqtptools__math__basic.html#gaecfd3a8f48b514e8ce878d0b6a3ff488" title="returns the inversely proportional value 1/v of v and ensures that , uses absMinV=std::numeric_limits...">jkqtp_inversePropSaveDefault()</a>. The default is <a class="el" href="group__jkqtptools__math__basic.html#gaf65c45af31289372105c13b5970aa7a2" title="returns the given value v (i.e. identity function)">jkqtp_identity()</a>, which just returns the values. In the case of <a class="el" href="group__jkqtptools__math__basic.html#gaecfd3a8f48b514e8ce878d0b6a3ff488" title="returns the inversely proportional value 1/v of v and ensures that , uses absMinV=std::numeric_limits...">jkqtp_inversePropSaveDefault()</a>, a datapoint x,y, has a large weight, if it's error is small and in the case if <a class="el" href="group__jkqtptools__math__basic.html#gaf65c45af31289372105c13b5970aa7a2" title="returns the given value v (i.e. identity function)">jkqtp_identity()</a> it's weight is directly proportional to the given value. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>weighted coeffcicient of determination <p class="formulaDsp">
<img class="formulaDsp" alt="\[ R^2=1-\frac{\sum_iw_i^2\bigl[y_i-f(x_i)\bigr]^2}{\sum_iw_i^2\bigl[y_i-\overline{y}\bigr]^2} \]" src="form_170.png" width="208" height="52"/>
</p>
 where <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \overline{y}=\frac{1}{N}\cdot\sum_iw_iy_i \]" src="form_171.png" width="117" height="42"/>
</p>
 with <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \sum_iw_i=1 \]" src="form_172.png" width="73" height="36"/>
</p>
</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a href="https://en.wikipedia.org/wiki/Coefficient_of_determination">https://en.wikipedia.org/wiki/Coefficient_of_determination</a> </dd></dl>

</div>
</div>
<a id="gaa6abec21468e0c369200d7fc92589531"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa6abec21468e0c369200d7fc92589531">&#9670;&nbsp;</a></span>jkqtpstatWeightedRegression()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class InputItX , class InputItY , class InputItW &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void jkqtpstatWeightedRegression </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__jkqtptools__math__statistics__regression.html#gaa798f2573e7f03cb328b15ff76dda335">JKQTPStatRegressionModelType</a>&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">InputItX&#160;</td>
          <td class="paramname"><em>firstX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">InputItX&#160;</td>
          <td class="paramname"><em>lastX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">InputItY&#160;</td>
          <td class="paramname"><em>firstY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">InputItY&#160;</td>
          <td class="paramname"><em>lastY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">InputItW&#160;</td>
          <td class="paramname"><em>firstW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">InputItW&#160;</td>
          <td class="paramname"><em>lastW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>coeffA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>coeffB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>fixA</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>fixB</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::function&lt; double(double)&gt;&#160;</td>
          <td class="paramname"><em>fWeightDataToWi</em> = <code>&amp;<a class="el" href="group__jkqtptools__math__basic.html#gaf65c45af31289372105c13b5970aa7a2">jkqtp_identity</a>&lt;double&gt;</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>calculate the robust linear regression coefficients for a given data range <em>firstX</em> / <em>firstY</em> ... <em>lastX</em> / <em>lastY</em> where the model is defined by <em>type</em> So this function solves the Lp-norm optimization problem: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ (a^\ast, b^\ast)=\mathop{\mathrm{arg\;min}}\limits_{a,b}\sum\limits_iw_i^2\left(y_i-f_{\text{type}}(x_i,a,b)\right)^2 \]" src="form_165.png" width="320" height="36"/>
</p>
<p> by reducing it to a linear fit by transforming x- and/or y-data</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">InputItX</td><td>standard iterator type of <em>firstX</em> and <em>lastX</em>. </td></tr>
    <tr><td class="paramname">InputItY</td><td>standard iterator type of <em>firstY</em> and <em>lastY</em>. </td></tr>
    <tr><td class="paramname">InputItW</td><td>standard iterator type of <em>firstW</em> and <em>lastW</em>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">type</td><td>model to be fitted </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">firstX</td><td>iterator pointing to the first item in the x-dataset to use <img class="formulaInl" alt="$ x_1 $" src="form_123.png" width="16" height="11"/> </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">lastX</td><td>iterator pointing behind the last item in the x-dataset to use <img class="formulaInl" alt="$ x_N $" src="form_124.png" width="21" height="11"/> </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">firstY</td><td>iterator pointing to the first item in the y-dataset to use <img class="formulaInl" alt="$ y_1 $" src="form_125.png" width="15" height="11"/> </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">lastY</td><td>iterator pointing behind the last item in the y-dataset to use <img class="formulaInl" alt="$ y_N $" src="form_126.png" width="21" height="11"/> </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">firstW</td><td>iterator pointing to the first item in the weight-dataset to use <img class="formulaInl" alt="$ w_1 $" src="form_136.png" width="20" height="11"/> </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">lastW</td><td>iterator pointing behind the last item in the weight-dataset to use <img class="formulaInl" alt="$ w_N $" src="form_137.png" width="24" height="11"/> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">coeffA</td><td>returns the offset of the linear model </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">coeffB</td><td>returns the slope of the linear model </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">fixA</td><td>if <code>true</code>, the offset coefficient <img class="formulaInl" alt="$ a $" src="form_131.png" width="8" height="8"/> is not determined by the fit, but the value provided in <em>coeffA</em> is used </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">fixB</td><td>if <code>true</code>, the slope coefficient <img class="formulaInl" alt="$ b $" src="form_132.png" width="7" height="13"/> is not determined by the fit, but the value provided in <em>coeffB</em> is used </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">fWeightDataToWi</td><td>an optional function, which is applied to the data from <em>firstW</em> ... <em>lastW</em> to convert them to weight, i.e. <code>wi=fWeightDataToWi(*itW)</code> e.g. if you use data used to draw error bars, you can use <a class="el" href="group__jkqtptools__math__basic.html#gaecfd3a8f48b514e8ce878d0b6a3ff488" title="returns the inversely proportional value 1/v of v and ensures that , uses absMinV=std::numeric_limits...">jkqtp_inversePropSaveDefault()</a>. The default is <a class="el" href="group__jkqtptools__math__basic.html#gaf65c45af31289372105c13b5970aa7a2" title="returns the given value v (i.e. identity function)">jkqtp_identity()</a>, which just returns the values. In the case of <a class="el" href="group__jkqtptools__math__basic.html#gaecfd3a8f48b514e8ce878d0b6a3ff488" title="returns the inversely proportional value 1/v of v and ensures that , uses absMinV=std::numeric_limits...">jkqtp_inversePropSaveDefault()</a>, a datapoint x,y, has a large weight, if it's error is small and in the case if <a class="el" href="group__jkqtptools__math__basic.html#gaf65c45af31289372105c13b5970aa7a2" title="returns the given value v (i.e. identity function)">jkqtp_identity()</a> it's weight is directly proportional to the given value.</td></tr>
  </table>
  </dd>
</dl>
<p>This function computes internally first transforms the data, as appropriate to fit the model defined by <em>type</em> and then calls <a class="el" href="group__jkqtptools__math__statistics__regression.html#gab5c23e5d003ffde1fbf9a089ea454659" title="calculate the weighted linear regression coefficients for a given for a given data range firstX / fir...">jkqtpstatLinearWeightedRegression()</a> to obtain the parameters. The output parameters are transformed, so they can be used with <a class="el" href="group__jkqtptools__math__statistics__regression.html#ga4d8e68bdb86c24be6ef6595135697988" title="Generates functors f(x,a,b) for the models from JKQTPStatRegressionModelType in type.">jkqtpStatGenerateRegressionModel()</a> to generate a functor that evaluates the model</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__jkqtptools__math__statistics__regression.html#gaa798f2573e7f03cb328b15ff76dda335" title="when performing linear regression, different target functions can be fitted, if the input data is tra...">JKQTPStatRegressionModelType</a>, <a class="el" href="group__jkqtptools__math__statistics__regression.html#ga4d8e68bdb86c24be6ef6595135697988" title="Generates functors f(x,a,b) for the models from JKQTPStatRegressionModelType in type.">jkqtpStatGenerateRegressionModel()</a>, <a class="el" href="group__jkqtptools__math__statistics__regression.html#gab5c23e5d003ffde1fbf9a089ea454659" title="calculate the weighted linear regression coefficients for a given for a given data range firstX / fir...">jkqtpstatLinearWeightedRegression()</a>, <a class="el" href="group__jkqtptools__math__statistics__regression.html#ga73ce65c9215066e78f0dd42ace00887a" title="Generates the transformation function for x-data (result.first ) and y-data (result....">jkqtpStatGenerateTransformation()</a> </dd></dl>

</div>
</div>
<a id="ga779070dee90458063383566992c0138a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga779070dee90458063383566992c0138a">&#9670;&nbsp;</a></span>jkqtpstatWeightedSumOfDeviations()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class InputItX , class InputItY , class InputItW &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double jkqtpstatWeightedSumOfDeviations </td>
          <td>(</td>
          <td class="paramtype">InputItX&#160;</td>
          <td class="paramname"><em>firstX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">InputItX&#160;</td>
          <td class="paramname"><em>lastX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">InputItY&#160;</td>
          <td class="paramname"><em>firstY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">InputItY&#160;</td>
          <td class="paramname"><em>lastY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">InputItW&#160;</td>
          <td class="paramname"><em>firstW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">InputItW&#160;</td>
          <td class="paramname"><em>lastW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::function&lt; double(double)&gt;&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::function&lt; double(double)&gt;&#160;</td>
          <td class="paramname"><em>fWeightDataToWi</em> = <code>&amp;<a class="el" href="group__jkqtptools__math__basic.html#gaf65c45af31289372105c13b5970aa7a2">jkqtp_identity</a>&lt;double&gt;</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>calculates the weighted sum of deviations <img class="formulaInl" alt="$ \chi^2 $" src="form_173.png" width="18" height="18"/> for a set of measurements <img class="formulaInl" alt="$ (x_i,y_i,w_i) $" src="form_169.png" width="70" height="18"/> with a fit function <img class="formulaInl" alt="$ f(x) $" src="form_88.png" width="31" height="18"/> </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">InputItX</td><td>standard iterator type of <em>firstX</em> and <em>lastX</em>. </td></tr>
    <tr><td class="paramname">InputItY</td><td>standard iterator type of <em>firstY</em> and <em>lastY</em>. </td></tr>
    <tr><td class="paramname">InputItW</td><td>standard iterator type of <em>firstW</em> and <em>lastW</em>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">firstX</td><td>iterator pointing to the first item in the x-dataset to use <img class="formulaInl" alt="$ x_1 $" src="form_123.png" width="16" height="11"/> </td></tr>
    <tr><td class="paramname">lastX</td><td>iterator pointing behind the last item in the x-dataset to use <img class="formulaInl" alt="$ x_N $" src="form_124.png" width="21" height="11"/> </td></tr>
    <tr><td class="paramname">firstY</td><td>iterator pointing to the first item in the y-dataset to use <img class="formulaInl" alt="$ y_1 $" src="form_125.png" width="15" height="11"/> </td></tr>
    <tr><td class="paramname">lastY</td><td>iterator pointing behind the last item in the y-dataset to use <img class="formulaInl" alt="$ y_N $" src="form_126.png" width="21" height="11"/> </td></tr>
    <tr><td class="paramname">firstW</td><td>iterator pointing to the first item in the weight-dataset to use <img class="formulaInl" alt="$ w_1 $" src="form_136.png" width="20" height="11"/> </td></tr>
    <tr><td class="paramname">lastW</td><td>iterator pointing behind the last item in the weight-dataset to use <img class="formulaInl" alt="$ w_N $" src="form_137.png" width="24" height="11"/> </td></tr>
    <tr><td class="paramname">f</td><td>function <img class="formulaInl" alt="$ f(x) $" src="form_88.png" width="31" height="18"/>, result of a fit to the data </td></tr>
    <tr><td class="paramname">fWeightDataToWi</td><td>an optional function, which is applied to the data from <em>firstW</em> ... <em>lastW</em> to convert them to weight, i.e. <code>wi=fWeightDataToWi(*itW)</code> e.g. if you use data used to draw error bars, you can use <a class="el" href="group__jkqtptools__math__basic.html#gaecfd3a8f48b514e8ce878d0b6a3ff488" title="returns the inversely proportional value 1/v of v and ensures that , uses absMinV=std::numeric_limits...">jkqtp_inversePropSaveDefault()</a>. The default is <a class="el" href="group__jkqtptools__math__basic.html#gaf65c45af31289372105c13b5970aa7a2" title="returns the given value v (i.e. identity function)">jkqtp_identity()</a>, which just returns the values. In the case of <a class="el" href="group__jkqtptools__math__basic.html#gaecfd3a8f48b514e8ce878d0b6a3ff488" title="returns the inversely proportional value 1/v of v and ensures that , uses absMinV=std::numeric_limits...">jkqtp_inversePropSaveDefault()</a>, a datapoint x,y, has a large weight, if it's error is small and in the case if <a class="el" href="group__jkqtptools__math__basic.html#gaf65c45af31289372105c13b5970aa7a2" title="returns the given value v (i.e. identity function)">jkqtp_identity()</a> it's weight is directly proportional to the given value. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>weighted sum of deviations <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \chi^2=\sum_iw_i^2\cdot\bigl[y_i-f(x_i)\bigr]^2 \]" src="form_175.png" width="187" height="37"/>
</p>
</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a href="https://en.wikipedia.org/wiki/Reduced_chi-squared_statistic">https://en.wikipedia.org/wiki/Reduced_chi-squared_statistic</a> </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Sat Sep 19 2020 18:03:19 for JKQTPlotter by <a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
