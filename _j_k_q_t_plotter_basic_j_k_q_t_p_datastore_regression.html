<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>JKQTPlotter: Tutorial (JKQTPDatastore): Regression Analysis (with the Statistics Library)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="jkqtplotter_stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">JKQTPlotter
   </div>
   <div id="projectbrief">an extensive Qt5 Plotter framework (including a feature-richt plotter widget, a speed-optimized, but limited variant and a LaTeX equation renderer!), written fully in C/C++ and without external dependencies</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_j_k_q_t_plotter_basic_j_k_q_t_p_datastore_regression.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Tutorial (<a class="el" href="class_j_k_q_t_p_datastore.html" title="This class manages data columns (with entries of type double ), used by JKQTPlotter/JKQTBasePlotter t...">JKQTPDatastore</a>): Regression Analysis (with the Statistics Library) </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md46">Simple Linear Regression</a></li>
<li class="level1"><a href="#autotoc_md47">Robust Linear Regression</a></li>
<li class="level1"><a href="#autotoc_md48">Weighted Linear Regression</a></li>
<li class="level1"><a href="#autotoc_md49">Linearizable Regression Models</a></li>
<li class="level1"><a href="#autotoc_md50">Polynom Fitting</a></li>
<li class="level1"><a href="#autotoc_md51">Screenshot of the full Program</a></li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md__home_travis_build_jkriege2_JKQtPlotter_examples_datastore_regression_README"></a></p>
<p>This tutorial project (see <code>./examples/datastore_statistics/</code>) explains several advanced functions of <a class="el" href="class_j_k_q_t_p_datastore.html" title="This class manages data columns (with entries of type double ), used by JKQTPlotter/JKQTBasePlotter t...">JKQTPDatastore</a> in combination with the [<a class="el" href="group__jkqtptools__math__statistics.html">JKQTPlotter Statistics Library</a>] conatined in <a class="el" href="class_j_k_q_t_plotter.html" title="plotter widget for scientific plots (uses JKQTBasePlotter to do the actual drawing)">JKQTPlotter</a>.</p>
<p><em><b>Note</b></em> that there are additional tutorial explaining other aspects of data mangement in <a class="el" href="class_j_k_q_t_p_datastore.html" title="This class manages data columns (with entries of type double ), used by JKQTPlotter/JKQTBasePlotter t...">JKQTPDatastore</a>:</p><ul>
<li><a class="el" href="_j_k_q_t_plotter_basic_j_k_q_t_p_datastore.html">Basic Usage of JKQTPDatastore</a></li>
<li><a class="el" href="_j_k_q_t_plotter_basic_j_k_q_t_p_datastore_iterators.html">Iterator-Based usage of JKQTPDatastore</a></li>
<li><a class="el" href="_j_k_q_t_plotter_basic_j_k_q_t_p_datastore_statistics.html">Advanced 1-Dimensional Statistics with JKQTPDatastore</a></li>
<li><a class="el" href="_j_k_q_t_plotter_basic_j_k_q_t_p_datastore_regression.html">Regression Analysis (with the Statistics Library)</a></li>
<li><a class="el" href="_j_k_q_t_plotter_basic_j_k_q_t_p_datastore_statistics_grouped_stat.html">1-Dimensional Group Statistics with JKQTPDatastore</a></li>
<li><a class="el" href="_j_k_q_t_plotter_basic_j_k_q_t_p_datastore_statistics2_d.html">Advanced 2-Dimensional Statistics with JKQTPDatastore</a></li>
</ul>
<p>The source code of the main application can be found in <a href="https://github.com/jkriege2/JKQtPlotter/tree/master/examples/datastore_statistics/datastore_regression.cpp"><code>datastore_regression.cpp</code></a>. This tutorial cites only parts of this code to demonstrate different ways of performing regression analysis.</p>
<h1><a class="anchor" id="autotoc_md46"></a>
Simple Linear Regression</h1>
<p>First we generate a set of datapoints (x,y), which scatter randomly around a linear function. </p><div class="fragment"><div class="line">std::random_device rd; <span class="comment">// random number generators:</span></div>
<div class="line">std::mt19937 gen{rd()};</div>
<div class="line">std::normal_distribution&lt;&gt; d1{0,1};</div>
<div class="line"><span class="keywordtype">double</span> a0=-5;</div>
<div class="line"><span class="keywordtype">double</span> b0=2;</div>
<div class="line"><span class="keywordtype">size_t</span> colLinX=datastore1-&gt;addColumn(<span class="stringliteral">&quot;lin data, x&quot;</span>);</div>
<div class="line"><span class="keywordtype">size_t</span> colLinY=datastore1-&gt;addColumn(<span class="stringliteral">&quot;lin data, y&quot;</span>);</div>
<div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">double</span> x=-5; x&lt;=10; x++) {</div>
<div class="line">    datastore1-&gt;appendToColumn(colLinX, x);</div>
<div class="line">    datastore1-&gt;appendToColumn(colLinY, a0+b0*x+d1(gen));</div>
<div class="line">}</div>
</div><!-- fragment --><p>... and we visualize this data with a simple scatter graph: </p><div class="fragment"><div class="line"><a class="code" href="class_j_k_q_t_p_x_y_line_graph.html">JKQTPXYLineGraph</a>* graphD;</div>
<div class="line">plot1-&gt;addGraph(graphD=<span class="keyword">new</span> <a class="code" href="class_j_k_q_t_p_x_y_line_graph.html">JKQTPXYLineGraph</a>(plot1));</div>
<div class="line">graphD-&gt;<a class="code" href="class_j_k_q_t_p_x_y_graph.html#a972ee50c53accadade8880b3bd1110cc">setXYColumns</a>(colLinX, colLinY);</div>
<div class="line">graphD-&gt;<a class="code" href="class_j_k_q_t_p_x_y_line_graph.html#a1202afd954530d0c71c9a745755f7ae0">setDrawLine</a>(<span class="keyword">false</span>);</div>
<div class="line">graphD-&gt;<a class="code" href="class_j_k_q_t_p_plot_element.html#a02a8d7c24cde7768f0134cee1aa1159d">setTitle</a>(<span class="stringliteral">&quot;data&quot;</span>);</div>
</div><!-- fragment --><p>Now we can caluate the regression line (i.e. the two regression coefficients a and b of the function <code>f(x)=a+b*x</code>) using the function <code><a class="el" href="group__jkqtptools__math__statistics__regression.html#gaf81a452c8e0798f6bb4b8764dd5a2f89" title="calculate the linear regression coefficients for a given data range firstX / firstY ....">jkqtpstatLinearRegression()</a></code> from the [statisticslibrary]: </p><div class="fragment"><div class="line"><span class="keywordtype">double</span> coeffA=0, coeffB=0;</div>
<div class="line"><a class="code" href="group__jkqtptools__math__statistics__regression.html#gaf81a452c8e0798f6bb4b8764dd5a2f89">jkqtpstatLinearRegression</a>(datastore1-&gt;begin(colLinX), datastore1-&gt;end(colLinX), datastore1-&gt;begin(colLinY), datastore1-&gt;end(colLinY), coeffA, coeffB);</div>
</div><!-- fragment --><p>... and add a <code><a class="el" href="class_j_k_q_t_p_x_function_line_graph.html" title="This implements line plots where the data is taken from a user supplied function .">JKQTPXFunctionLineGraph</a></code> to draw the resulting linear function: </p><div class="fragment"><div class="line"><a class="code" href="class_j_k_q_t_p_x_function_line_graph.html">JKQTPXFunctionLineGraph</a> *graphRegLine=<span class="keyword">new</span> <a class="code" href="class_j_k_q_t_p_x_function_line_graph.html">JKQTPXFunctionLineGraph</a>(plot1);</div>
<div class="line">graphRegLine-&gt;<a class="code" href="class_j_k_q_t_p_functor_line_graph_base.html#a54839fbc43deffbd05aa204322b5443d">setSpecialFunction</a>(JKQTPXFunctionLineGraph::SpecialFunction::Line);</div>
<div class="line">graphRegLine-&gt;<a class="code" href="class_j_k_q_t_p_evaluated_function_graph_base.html#aa3f1098c5ab09c8be6dca50346254205">setParamsV</a>(coeffA, coeffB);</div>
<div class="line">graphRegLine-&gt;<a class="code" href="class_j_k_q_t_p_plot_element.html#a02a8d7c24cde7768f0134cee1aa1159d">setTitle</a>(QString(<span class="stringliteral">&quot;regression: $f(x) = %1 + %2 \\cdot x$&quot;</span>).arg(<a class="code" href="group__jkqtptools__string.html#ga4f7343eadd4604477092123377981777">jkqtp_floattolatexqstr</a>(coeffA)).arg(<a class="code" href="group__jkqtptools__string.html#ga4f7343eadd4604477092123377981777">jkqtp_floattolatexqstr</a>(coeffB)));</div>
<div class="line">plot1-&gt;addGraph(graphRegLine);</div>
</div><!-- fragment --><p>These two steps can be simplified using an "adaptor": </p><div class="fragment"><div class="line"><a class="code" href="group__jkqtptools__math__statistics__adaptors.html#ga72f5744b994b78860ab0e9e9e560ce2b">jkqtpstatAddLinearRegression</a>(plot1-&gt;getPlotter(), datastore1-&gt;begin(colLinX), datastore1-&gt;end(colLinX), datastore1-&gt;begin(colLinY), datastore1-&gt;end(colLinY));</div>
</div><!-- fragment --><p>... or even shorter: </p><div class="fragment"><div class="line"><a class="code" href="group__jkqtptools__math__statistics__adaptors.html#ga72f5744b994b78860ab0e9e9e560ce2b">jkqtpstatAddLinearRegression</a>(graphD);</div>
</div><!-- fragment --><p>Here the x- and y-columns from the <code><a class="el" href="class_j_k_q_t_p_x_y_graph.html" title="This virtual JKQTPGraph descendent may be used as base for all graphs that use at least two columns t...">JKQTPXYGraph</a></code>-based graph <code>graphD</code> (see above) are used as datasources for the plot.</p>
<p>The plot resulting from any of the variants above looks like this:</p>
<p><img src="https://raw.githubusercontent.com/jkriege2/JKQtPlotter/master/screenshots/datastore_regression_lin.png" alt="datastore_regression_lin" class="inline"/></p>
<h1><a class="anchor" id="autotoc_md47"></a>
Robust Linear Regression</h1>
<p>Sometimes data contains outliers that can render the results of a regression analysis inaccurate. For such cases the <a class="el" href="group__jkqtptools__math__statistics.html">JKQTPlotter Statistics Library</a> offers the function <code><a class="el" href="group__jkqtptools__math__statistics__regression.html#ga7da14476c0d4bc417ec104dbcc930bb6" title="calculate the (robust) iteratively reweighted least-squares (IRLS) estimate for the parameters of the...">jkqtpstatRobustIRLSLinearRegression()</a></code>, which is a drop-in replacement for <code><a class="el" href="group__jkqtptools__math__statistics__regression.html#gaf81a452c8e0798f6bb4b8764dd5a2f89" title="calculate the linear regression coefficients for a given data range firstX / firstY ....">jkqtpstatLinearRegression()</a></code> and solves the optimization problem a) in the Lp-norm (which is more robust to outliers) and b) uses the <a href="https://en.wikipedia.org/wiki/Iteratively_reweighted_least_squares">iteratively reweighted least-squares algorithm (IRLS)</a>, which performs a series of regressions, where in each instance the data-points are weighted differently. The method assigns a lower weight to those points that are far from the current best-fit (typically the outliers) and thus slowly comes nearer to an estimate that is not distorted by the outliers.</p>
<p>To demonstrate this method, we use the same dataset as above, but add a few outliers:</p>
<div class="fragment"><div class="line">std::random_device rd; <span class="comment">// random number generators:</span></div>
<div class="line">std::mt19937 gen{rd()};</div>
<div class="line">std::normal_distribution&lt;&gt; d1{0,1};</div>
<div class="line"><span class="keywordtype">double</span> a0=-5;</div>
<div class="line"><span class="keywordtype">double</span> b0=2;</div>
<div class="line"><span class="keywordtype">size_t</span> colLinX=datastore1-&gt;addColumn(<span class="stringliteral">&quot;lin data, x&quot;</span>);</div>
<div class="line"><span class="keywordtype">size_t</span> colLinY=datastore1-&gt;addColumn(<span class="stringliteral">&quot;lin data, y&quot;</span>);</div>
<div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">double</span> x=-5; x&lt;=10; x++) {</div>
<div class="line">    datastore1-&gt;appendToColumn(colLinX, x);</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="group__jkqtptools__math__basic.html#gad8ae0cbd634f3079f88d87310504d62e">jkqtp_approximatelyEqual</a>(x, -5)||<a class="code" href="group__jkqtptools__math__basic.html#gad8ae0cbd634f3079f88d87310504d62e">jkqtp_approximatelyEqual</a>(x, -3)) datastore1-&gt;appendToColumn(colRLinY, a0+b0*x+d1(gen)+12);</div>
<div class="line">    <span class="keywordflow">else</span> datastore1-&gt;appendToColumn(colRLinY, a0+b0*x+d1(gen));</div>
<div class="line">}</div>
</div><!-- fragment --><p>Note the outliers ar x=-5 and x=-3!</p>
<p>With this dataset we can use the same code as above, but with <code><a class="el" href="group__jkqtptools__math__statistics__regression.html#ga7da14476c0d4bc417ec104dbcc930bb6" title="calculate the (robust) iteratively reweighted least-squares (IRLS) estimate for the parameters of the...">jkqtpstatRobustIRLSLinearRegression()</a></code> instead of <code><a class="el" href="group__jkqtptools__math__statistics__regression.html#gaf81a452c8e0798f6bb4b8764dd5a2f89" title="calculate the linear regression coefficients for a given data range firstX / firstY ....">jkqtpstatLinearRegression()</a></code>:</p>
<div class="fragment"><div class="line"><span class="keywordtype">double</span> coeffA=0, coeffB=0;</div>
<div class="line"><a class="code" href="group__jkqtptools__math__statistics__regression.html#ga7da14476c0d4bc417ec104dbcc930bb6">jkqtpstatRobustIRLSLinearRegression</a>(datastore1-&gt;begin(colRLinX), datastore1-&gt;end(colRLinX), datastore1-&gt;begin(colRLinY), datastore1-&gt;end(colRLinY), coeffA, coeffB);</div>
<div class="line"><a class="code" href="class_j_k_q_t_p_x_function_line_graph.html">JKQTPXFunctionLineGraph</a> *graphRegLine=<span class="keyword">new</span> <a class="code" href="class_j_k_q_t_p_x_function_line_graph.html">JKQTPXFunctionLineGraph</a>(plot3);</div>
<div class="line">graphRegLine-&gt;<a class="code" href="class_j_k_q_t_p_functor_line_graph_base.html#a54839fbc43deffbd05aa204322b5443d">setSpecialFunction</a>(JKQTPXFunctionLineGraph::SpecialFunction::Line);</div>
<div class="line">graphRegLine-&gt;<a class="code" href="class_j_k_q_t_p_evaluated_function_graph_base.html#aa3f1098c5ab09c8be6dca50346254205">setParamsV</a>(coeffA, coeffB);</div>
<div class="line">graphRegLine-&gt;<a class="code" href="class_j_k_q_t_p_plot_element.html#a02a8d7c24cde7768f0134cee1aa1159d">setTitle</a>(QString(<span class="stringliteral">&quot;robust regression: $f(x) = %1 + %2 \\cdot x$&quot;</span>).arg(<a class="code" href="group__jkqtptools__string.html#ga4f7343eadd4604477092123377981777">jkqtp_floattolatexqstr</a>(coeffA)).arg(<a class="code" href="group__jkqtptools__string.html#ga4f7343eadd4604477092123377981777">jkqtp_floattolatexqstr</a>(coeffB)));</div>
<div class="line">plot3-&gt;addGraph(graphRegLine);</div>
</div><!-- fragment --><p>Also for the robust regression, there are two shortcuts in the form of "adaptors": </p><div class="fragment"><div class="line"><a class="code" href="group__jkqtptools__math__statistics__adaptors.html#ga9f4f7d2237a4d285dfd76b45084b0cd5">jkqtpstatAddRobustIRLSLinearRegression</a>(plot3-&gt;getPlotter(), datastore1-&gt;begin(colRLinX), datastore1-&gt;end(colRLinX), datastore1-&gt;begin(colRLinY), datastore1-&gt;end(colRLinY));</div>
</div><!-- fragment --><p>and </p><div class="fragment"><div class="line"><a class="code" href="group__jkqtptools__math__statistics__adaptors.html#ga9f4f7d2237a4d285dfd76b45084b0cd5">jkqtpstatAddRobustIRLSLinearRegression</a>(graphD);</div>
</div><!-- fragment --><p>The following screenshot shows the result of the IRLS regression analysis and for comparison the normal linear regression for the same dataset (plotted using <code>jkqtpstatAddLinearRegression(graphD);</code>):</p>
<p><img src="https://raw.githubusercontent.com/jkriege2/JKQtPlotter/master/screenshots/datastore_regression_linrobust.png" alt="datastore_regression_linrobust" class="inline"/></p>
<p>The following screenshot shows the influence of the regularization parameter p (default value 1.1) onto the fit result:</p><ul>
<li>the closer <code>p</code> is to 1, the more robust the fit is (it is closer to the L1-norm)</li>
<li>the closer <code>p</code> is to 2, the closer the fit is to the least squares solution (i.e. the normal regression obtained with the L2 norm)</li>
</ul>
<p><img src="https://raw.githubusercontent.com/jkriege2/JKQtPlotter/master/screenshots/datastore_regression_linrobust_p.png" alt="datastore_regression_linrobust_p" class="inline"/></p>
<h1><a class="anchor" id="autotoc_md48"></a>
Weighted Linear Regression</h1>
<p>Another option to react to measurement errors is to take these into account when calculating the regression. To do so, you can use weighted regression that uses the measurement errors as inverse weights. This algorithm is implemented in the function <code><a class="el" href="group__jkqtptools__math__statistics__regression.html#gab5c23e5d003ffde1fbf9a089ea454659" title="calculate the weighted linear regression coefficients for a given for a given data range firstX / fir...">jkqtpstatLinearWeightedRegression()</a></code>.</p>
<p>First we generate again a set of datapoints (x,y), which scatter randomly around a linear function. In addition we calculate an "error" <code>err</code> for each datapoint: </p><div class="fragment"><div class="line">std::random_device rd; <span class="comment">// random number generators:</span></div>
<div class="line">std::mt19937 gen{rd()};</div>
<div class="line">std::uniform_real_distribution&lt;&gt; de{0.5,1.5};</div>
<div class="line">std::uniform_int_distribution&lt;&gt; ddecide{0,4};</div>
<div class="line"><span class="keywordtype">double</span> a0=-5;</div>
<div class="line"><span class="keywordtype">double</span> b0=2;</div>
<div class="line"><span class="keywordtype">size_t</span> colWLinX=datastore1-&gt;addColumn(<span class="stringliteral">&quot;wlin data, x&quot;</span>);</div>
<div class="line"><span class="keywordtype">size_t</span> colWLinY=datastore1-&gt;addColumn(<span class="stringliteral">&quot;wlin data, y&quot;</span>);</div>
<div class="line"><span class="keywordtype">size_t</span> colWLinE=datastore1-&gt;addColumn(<span class="stringliteral">&quot;wlin data, errors&quot;</span>);</div>
<div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">double</span> x=-5; x&lt;=10; x++) {</div>
<div class="line">    <span class="keywordtype">double</span> factor=1;</div>
<div class="line">    <span class="keywordflow">if</span> (ddecide(gen)==4) {</div>
<div class="line">        factor=4;</div>
<div class="line">    }</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> err=de(gen)*factor;</div>
<div class="line">    datastore1-&gt;appendToColumn(colWLinX, x);</div>
<div class="line">    datastore1-&gt;appendToColumn(colWLinY, a0+b0*x+err);</div>
<div class="line">    datastore1-&gt;appendToColumn(colWLinE, 1.0/err);</div>
<div class="line">}</div>
</div><!-- fragment --><p>We use distribution <code>de</code> to draw deviations from the ideal linear function from the range 0.5...1.5. then - for good measure - we use a second distribution <code>ddecide</code> (dice tossing) to select a few datapoints to have a 4-fold increased error.</p>
<p>Finally we visualize this data with a simple scatter graph with error indicators: </p><div class="fragment"><div class="line"><a class="code" href="class_j_k_q_t_p_x_y_line_error_graph.html">JKQTPXYLineErrorGraph</a>* graphE;</div>
<div class="line">plot2-&gt;addGraph(graphE=<span class="keyword">new</span> <a class="code" href="class_j_k_q_t_p_x_y_line_error_graph.html">JKQTPXYLineErrorGraph</a>(plot2));</div>
<div class="line">graphE-&gt;<a class="code" href="class_j_k_q_t_p_x_y_graph.html#a972ee50c53accadade8880b3bd1110cc">setXYColumns</a>(colWLinX, colWLinY);</div>
<div class="line">graphE-&gt;<a class="code" href="class_j_k_q_t_p_y_graph_error_data.html#a52350a8da0cbce7a98e6da445ad28b11">setYErrorColumn</a>(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(colWLinE));</div>
<div class="line">graphE-&gt;<a class="code" href="class_j_k_q_t_p_x_y_line_graph.html#a1202afd954530d0c71c9a745755f7ae0">setDrawLine</a>(<span class="keyword">false</span>);</div>
<div class="line">graphE-&gt;<a class="code" href="class_j_k_q_t_p_plot_element.html#a02a8d7c24cde7768f0134cee1aa1159d">setTitle</a>(<span class="stringliteral">&quot;data&quot;</span>);</div>
</div><!-- fragment --><p>Now we can caluate the regression line (i.e. the two regression coefficients a and b of the function <code>f(x)=a+b*x</code>) using the function <code><a class="el" href="group__jkqtptools__math__statistics__regression.html#gab5c23e5d003ffde1fbf9a089ea454659" title="calculate the weighted linear regression coefficients for a given for a given data range firstX / fir...">jkqtpstatLinearWeightedRegression()</a></code> from the [statisticslibrary]:</p>
<div class="fragment"><div class="line"><span class="keywordtype">double</span> coeffA=0, coeffB=0;</div>
<div class="line"><a class="code" href="group__jkqtptools__math__statistics__regression.html#gab5c23e5d003ffde1fbf9a089ea454659">jkqtpstatLinearWeightedRegression</a>(datastore1-&gt;begin(colWLinX), datastore1-&gt;end(colWLinX),</div>
<div class="line">                                  datastore1-&gt;begin(colWLinY), datastore1-&gt;end(colWLinY),</div>
<div class="line">                                  datastore1-&gt;begin(colWLinE), datastore1-&gt;end(colWLinE),</div>
<div class="line">                                  coeffA, coeffB, <span class="keyword">false</span>, <span class="keyword">false</span>,</div>
<div class="line">                                  &amp;jkqtp_inversePropSaveDefault&lt;double&gt;);</div>
</div><!-- fragment --><p><em><b>Note</b></em> that in addition to the three data-columns we also provided a C++ functor <code><a class="el" href="group__jkqtptools__math__basic.html#gaecfd3a8f48b514e8ce878d0b6a3ff488" title="returns the inversely proportional value 1/v of v and ensures that , uses absMinV=std::numeric_limits...">jkqtp_inversePropSaveDefault()</a></code>, which calculates 1/error. This is done, because the function <code><a class="el" href="group__jkqtptools__math__statistics__regression.html#gab5c23e5d003ffde1fbf9a089ea454659" title="calculate the weighted linear regression coefficients for a given for a given data range firstX / fir...">jkqtpstatLinearWeightedRegression()</a></code> uses the data from the range <code>datastore1-&gt;begin(colWLinE)</code> ... <code>datastore1-&gt;end(colWLinE)</code> directly as weights, but we calculated errors, which are inversely proportional to the weight of each data point when solving the least squares problem, as data points with larger errors should be weighted less than thos with smaller errors (outliers).</p>
<p>Again these two steps can be simplified using an "adaptor": </p><div class="fragment"><div class="line"><a class="code" href="group__jkqtptools__math__statistics__adaptors.html#ga03bbbd1a83a63cb7eb14eee9c3a73a34">jkqtpstatAddLinearWeightedRegression</a>(plot1-&gt;getPlotter(), </div>
<div class="line">                                     datastore1-&gt;begin(colLinX), datastore1-&gt;end(colLinX), </div>
<div class="line">                                     datastore1-&gt;begin(colLinY), datastore1-&gt;end(colLinY), </div>
<div class="line">                                     datastore1-&gt;begin(colWLinE), datastore1-&gt;end(colWLinE),</div>
<div class="line">                                     &amp;coeffA, &amp;coeffB, <span class="keyword">false</span>, <span class="keyword">false</span>,</div>
<div class="line">                                     &amp;jkqtp_inversePropSaveDefault&lt;double&gt;);</div>
</div><!-- fragment --><p>... or even shorter:</p>
<div class="fragment"><div class="line"><a class="code" href="group__jkqtptools__math__statistics__adaptors.html#ga03bbbd1a83a63cb7eb14eee9c3a73a34">jkqtpstatAddLinearWeightedRegression</a>(graphD);</div>
</div><!-- fragment --><p>Here the x- and y-columns from the <code><a class="el" href="class_j_k_q_t_p_x_y_graph.html" title="This virtual JKQTPGraph descendent may be used as base for all graphs that use at least two columns t...">JKQTPXYGraph</a></code>-based graph <code>graphE</code> (see above) and the weights from the error column of <code>graphE</code> are used as datasources for the plot. This function implicitly uses the function <code><a class="el" href="group__jkqtptools__math__basic.html#gaecfd3a8f48b514e8ce878d0b6a3ff488" title="returns the inversely proportional value 1/v of v and ensures that , uses absMinV=std::numeric_limits...">jkqtp_inversePropSaveDefault()</a></code> to convert plot errors to weights, as it is already clear that we are dealing with errors rather than direct weights.</p>
<p>The plot resulting from any of the variants above looks like this:</p>
<p><img src="https://raw.githubusercontent.com/jkriege2/JKQtPlotter/master/screenshots/datastore_regression_linweight.png" alt="datastore_regression_linweight" class="inline"/></p>
<p>For this plot we also added a call to </p><div class="fragment"><div class="line"><a class="code" href="group__jkqtptools__math__statistics__adaptors.html#ga72f5744b994b78860ab0e9e9e560ce2b">jkqtpstatAddLinearRegression</a>(graphE);</div>
</div><!-- fragment --><p>which performs a simple non-weighted regression. The difference between the two resulting linear functions (blue: simple regression, green: weighted regression) demonstrates the influence of the weighting.</p>
<h1><a class="anchor" id="autotoc_md49"></a>
Linearizable Regression Models</h1>
<p>In addition to the simple linear regression model <code>f(x)=a+b*x</code>, it is also possible to fit a few non-linear models by transforming the data:</p><ul>
<li>power-law function<code>f(x)=a*x^b</code>, which is a linear function in a log(x)-log(y)-plot</li>
<li>exponential function <code>f(x)=a*exp(b*x)</code>, which is a linear function in a x-log(y)-plot</li>
<li>logarithm function <code>f(x)=a+b*ln(x)</code>, which is a linear function in a exp(x)-y-plot The available models are defined in the enum <code>JKQTPStatRegressionModelType</code>. And there exists a function <code><a class="el" href="group__jkqtptools__math__statistics__regression.html#ga4d8e68bdb86c24be6ef6595135697988" title="Generates functors f(x,a,b) for the models from JKQTPStatRegressionModelType in type.">jkqtpStatGenerateRegressionModel()</a></code>, which returns a C++-functor representing the function.</li>
</ul>
<p>To demonstrate these fitting options, we first generate data from an exponential and a power-law model. Note that we also add normally distributed errors, but in order to ensure that we do not obtain y-values &lt;0, we use loops that draw normally distributed random numbers, until this condition is met:</p>
<div class="fragment"><div class="line">std::random_device rd; <span class="comment">// random number generators:</span></div>
<div class="line">std::mt19937 gen{rd()};</div>
<div class="line">std::normal_distribution&lt;&gt; d1{0,1};</div>
<div class="line"><span class="keywordtype">double</span> a0_powerlaw=20;</div>
<div class="line"><span class="keywordtype">double</span> b0_powerlaw=0.25;</div>
<div class="line"><span class="keywordtype">double</span> a0_exp=5;</div>
<div class="line"><span class="keywordtype">double</span> b0_exp=0.5;</div>
<div class="line"><span class="keywordtype">size_t</span> colNLLinX=datastore1-&gt;addColumn(<span class="stringliteral">&quot;non-lin data, x&quot;</span>);</div>
<div class="line"><span class="keywordtype">size_t</span> colNLLinYExp=datastore1-&gt;addColumn(<span class="stringliteral">&quot;non-lin data, y, exponential model&quot;</span>);</div>
<div class="line"><span class="keywordtype">size_t</span> colNLLinYPow=datastore1-&gt;addColumn(<span class="stringliteral">&quot;non-lin data, y, power-law model&quot;</span>);</div>
<div class="line"><span class="keyword">auto</span> model_powerlaw=<a class="code" href="group__jkqtptools__math__statistics__regression.html#ga4d8e68bdb86c24be6ef6595135697988">jkqtpStatGenerateRegressionModel</a>(<a class="code" href="group__jkqtptools__math__statistics__regression.html#ggaa798f2573e7f03cb328b15ff76dda335a0421fde669f1f6a68f34f112af7c8809">JKQTPStatRegressionModelType::PowerLaw</a>);</div>
<div class="line"><span class="keyword">auto</span> model_exp=<a class="code" href="group__jkqtptools__math__statistics__regression.html#ga4d8e68bdb86c24be6ef6595135697988">jkqtpStatGenerateRegressionModel</a>(<a class="code" href="group__jkqtptools__math__statistics__regression.html#ggaa798f2573e7f03cb328b15ff76dda335ac1e19c09f700938f0ff7f1fd4722a3ac">JKQTPStatRegressionModelType::Exponential</a>);</div>
<div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">double</span> x=0.1; x&lt;=10; x+=0.5) {</div>
<div class="line">    datastore1-&gt;appendToColumn(colNLLinX, x);</div>
<div class="line">    <span class="keywordtype">double</span> ypow=model_powerlaw(x, a0_powerlaw, b0_powerlaw)+d1(gen);</div>
<div class="line">    <span class="keywordflow">while</span> (ypow&lt;0) {</div>
<div class="line">        ypow=model_powerlaw(x, a0_powerlaw, b0_powerlaw)+d1(gen);</div>
<div class="line">    }</div>
<div class="line">    datastore1-&gt;appendToColumn(colNLLinYPow, ypow);</div>
<div class="line">    <span class="keywordtype">double</span> yexp=model_exp(x, a0_exp, b0_exp)+d1(gen);</div>
<div class="line">    <span class="keywordflow">while</span> (yexp&lt;0) {</div>
<div class="line">        yexp=model_exp(x, a0_exp, b0_exp)+d1(gen);</div>
<div class="line">    }</div>
<div class="line">    datastore1-&gt;appendToColumn(colNLLinYExp, yexp);</div>
<div class="line">}</div>
</div><!-- fragment --><p>The generated data is visualized with scatter-plots: </p><div class="fragment"><div class="line"><a class="code" href="class_j_k_q_t_p_x_y_line_graph.html">JKQTPXYLineGraph</a>* graphD_powerlaw;</div>
<div class="line">plot5-&gt;addGraph(graphD_powerlaw=<span class="keyword">new</span> <a class="code" href="class_j_k_q_t_p_x_y_line_graph.html">JKQTPXYLineGraph</a>(plot5));</div>
<div class="line">graphD_powerlaw-&gt;<a class="code" href="class_j_k_q_t_p_x_y_graph.html#a972ee50c53accadade8880b3bd1110cc">setXYColumns</a>(colNLLinX, colNLLinYPow);</div>
<div class="line">graphD_powerlaw-&gt;<a class="code" href="class_j_k_q_t_p_x_y_line_graph.html#a1202afd954530d0c71c9a745755f7ae0">setDrawLine</a>(<span class="keyword">false</span>);</div>
<div class="line">graphD_powerlaw-&gt;<a class="code" href="class_j_k_q_t_p_plot_element.html#a02a8d7c24cde7768f0134cee1aa1159d">setTitle</a>(QString(<span class="stringliteral">&quot;data $%1+\\mathcal{N}(0,1)$&quot;</span>).arg(<a class="code" href="group__jkqtptools__math__statistics__regression.html#ga4d5788af55f493f384915cf012980432">jkqtpstatRegressionModel2Latex</a>(<a class="code" href="group__jkqtptools__math__statistics__regression.html#ggaa798f2573e7f03cb328b15ff76dda335a0421fde669f1f6a68f34f112af7c8809">JKQTPStatRegressionModelType::PowerLaw</a>, a0_powerlaw, b0_powerlaw)));</div>
<div class="line"><a class="code" href="class_j_k_q_t_p_x_y_line_graph.html">JKQTPXYLineGraph</a>* graphD_exp;</div>
<div class="line">plot4-&gt;addGraph(graphD_exp=<span class="keyword">new</span> <a class="code" href="class_j_k_q_t_p_x_y_line_graph.html">JKQTPXYLineGraph</a>(plot4));</div>
<div class="line">graphD_exp-&gt;<a class="code" href="class_j_k_q_t_p_x_y_graph.html#a972ee50c53accadade8880b3bd1110cc">setXYColumns</a>(colNLLinX, colNLLinYExp);</div>
<div class="line">graphD_exp-&gt;<a class="code" href="class_j_k_q_t_p_x_y_line_graph.html#a1202afd954530d0c71c9a745755f7ae0">setDrawLine</a>(<span class="keyword">false</span>);</div>
<div class="line">graphD_exp-&gt;<a class="code" href="class_j_k_q_t_p_plot_element.html#a02a8d7c24cde7768f0134cee1aa1159d">setTitle</a>(QString(<span class="stringliteral">&quot;data $%1+\\mathcal{N}(0,1)$&quot;</span>).arg(<a class="code" href="group__jkqtptools__math__statistics__regression.html#ga4d5788af55f493f384915cf012980432">jkqtpstatRegressionModel2Latex</a>(<a class="code" href="group__jkqtptools__math__statistics__regression.html#ggaa798f2573e7f03cb328b15ff76dda335ac1e19c09f700938f0ff7f1fd4722a3ac">JKQTPStatRegressionModelType::Exponential</a>, a0_exp, b0_exp)));</div>
</div><!-- fragment --><p>Now we can fit the regression models using <code><a class="el" href="group__jkqtptools__math__statistics__regression.html#ga71e0e49a1e5aaba294f4b9f7b3f25201" title="calculate the linear regression coefficients for a given data range firstX / firstY ....">jkqtpstatRegression()</a></code>, which receives the model type as first parameter: </p><div class="fragment"><div class="line"><span class="keywordtype">double</span> cA=0, cB=0;</div>
<div class="line"><a class="code" href="class_j_k_q_t_p_x_function_line_graph.html">JKQTPXFunctionLineGraph</a>* gFunc;</div>
<div class="line"><a class="code" href="group__jkqtptools__math__statistics__regression.html#ga71e0e49a1e5aaba294f4b9f7b3f25201">jkqtpstatRegression</a>(<a class="code" href="group__jkqtptools__math__statistics__regression.html#ggaa798f2573e7f03cb328b15ff76dda335ac1e19c09f700938f0ff7f1fd4722a3ac">JKQTPStatRegressionModelType::Exponential</a>, datastore1-&gt;begin(colNLLinX), datastore1-&gt;end(colNLLinX), datastore1-&gt;begin(colNLLinYExp), datastore1-&gt;end(colNLLinYExp), cA, cB);</div>
<div class="line">plot4-&gt;addGraph(gFunc=<span class="keyword">new</span> <a class="code" href="class_j_k_q_t_p_x_function_line_graph.html">JKQTPXFunctionLineGraph</a>(plot4));</div>
<div class="line">gFunc-&gt;<a class="code" href="class_j_k_q_t_p_functor_line_graph_base.html#a45af61ac31bd9e6b26c662ea532920bf">setPlotFunctionFunctor</a>(<a class="code" href="group__jkqtptools__math__statistics__regression.html#ga4d8e68bdb86c24be6ef6595135697988">jkqtpStatGenerateRegressionModel</a>(<a class="code" href="group__jkqtptools__math__statistics__regression.html#ggaa798f2573e7f03cb328b15ff76dda335ac1e19c09f700938f0ff7f1fd4722a3ac">JKQTPStatRegressionModelType::Exponential</a>, cA, cB));</div>
<div class="line">gFunc-&gt;<a class="code" href="class_j_k_q_t_p_plot_element.html#a02a8d7c24cde7768f0134cee1aa1159d">setTitle</a>(QString(<span class="stringliteral">&quot;regression: $%1$&quot;</span>).arg(<a class="code" href="group__jkqtptools__math__statistics__regression.html#ga4d5788af55f493f384915cf012980432">jkqtpstatRegressionModel2Latex</a>(<a class="code" href="group__jkqtptools__math__statistics__regression.html#ggaa798f2573e7f03cb328b15ff76dda335ac1e19c09f700938f0ff7f1fd4722a3ac">JKQTPStatRegressionModelType::Exponential</a>, cA, cB)));</div>
<div class="line">cA=0; cB=0;</div>
<div class="line"><a class="code" href="group__jkqtptools__math__statistics__regression.html#ga71e0e49a1e5aaba294f4b9f7b3f25201">jkqtpstatRegression</a>(<a class="code" href="group__jkqtptools__math__statistics__regression.html#ggaa798f2573e7f03cb328b15ff76dda335a0421fde669f1f6a68f34f112af7c8809">JKQTPStatRegressionModelType::PowerLaw</a>, datastore1-&gt;begin(colNLLinX), datastore1-&gt;end(colNLLinX), datastore1-&gt;begin(colNLLinYPow), datastore1-&gt;end(colNLLinYPow), cA, cB);</div>
<div class="line">plot5-&gt;addGraph(gFunc=<span class="keyword">new</span> <a class="code" href="class_j_k_q_t_p_x_function_line_graph.html">JKQTPXFunctionLineGraph</a>(plot5));</div>
<div class="line">gFunc-&gt;<a class="code" href="class_j_k_q_t_p_functor_line_graph_base.html#a45af61ac31bd9e6b26c662ea532920bf">setPlotFunctionFunctor</a>(<a class="code" href="group__jkqtptools__math__statistics__regression.html#ga4d8e68bdb86c24be6ef6595135697988">jkqtpStatGenerateRegressionModel</a>(<a class="code" href="group__jkqtptools__math__statistics__regression.html#ggaa798f2573e7f03cb328b15ff76dda335a0421fde669f1f6a68f34f112af7c8809">JKQTPStatRegressionModelType::PowerLaw</a>, cA, cB));</div>
<div class="line">gFunc-&gt;<a class="code" href="class_j_k_q_t_p_plot_element.html#a02a8d7c24cde7768f0134cee1aa1159d">setTitle</a>(QString(<span class="stringliteral">&quot;regression: $%1$&quot;</span>).arg(<a class="code" href="group__jkqtptools__math__statistics__regression.html#ga4d5788af55f493f384915cf012980432">jkqtpstatRegressionModel2Latex</a>(<a class="code" href="group__jkqtptools__math__statistics__regression.html#ggaa798f2573e7f03cb328b15ff76dda335a0421fde669f1f6a68f34f112af7c8809">JKQTPStatRegressionModelType::PowerLaw</a>, cA, cB)));</div>
</div><!-- fragment --><p>The regression models can be plotted using a <code><a class="el" href="class_j_k_q_t_p_x_function_line_graph.html" title="This implements line plots where the data is taken from a user supplied function .">JKQTPXFunctionLineGraph</a></code>. the fucntion to plot is again generated by calling <code><a class="el" href="group__jkqtptools__math__statistics__regression.html#ga4d8e68bdb86c24be6ef6595135697988" title="Generates functors f(x,a,b) for the models from JKQTPStatRegressionModelType in type.">jkqtpStatGenerateRegressionModel()</a></code>, but now with the parameters determined above the respective lines. Note that <code><a class="el" href="group__jkqtptools__math__statistics__regression.html#ga4d5788af55f493f384915cf012980432" title="Generates a LaTeX string for the models from JKQTPStatRegressionModelType in type.">jkqtpstatRegressionModel2Latex()</a></code> outputs the model as LaTeX string, which can be used as plot label.</p>
<p>The resulting plot looks like this:</p>
<p><img src="https://raw.githubusercontent.com/jkriege2/JKQtPlotter/master/screenshots/datastore_regression_nonlinreg.png" alt="datastore_regression_nonlinreg" class="inline"/></p>
<p>Of course also "adaptors" exist that allow to perform the steps above in a single function call:</p>
<div class="fragment"><div class="line"><a class="code" href="group__jkqtptools__math__statistics__adaptors.html#ga8ce3ce5c868aa676c9d7b29f35c037d6">jkqtpstatAddRegression</a>(plot4-&gt;getPlotter(), <a class="code" href="group__jkqtptools__math__statistics__regression.html#ggaa798f2573e7f03cb328b15ff76dda335ac1e19c09f700938f0ff7f1fd4722a3ac">JKQTPStatRegressionModelType::Exponential</a>, datastore1-&gt;begin(colNLLinX), datastore1-&gt;end(colNLLinX), datastore1-&gt;begin(colNLLinYExp), datastore1-&gt;end(colNLLinYExp));</div>
<div class="line"><a class="code" href="group__jkqtptools__math__statistics__adaptors.html#ga8ce3ce5c868aa676c9d7b29f35c037d6">jkqtpstatAddRegression</a>(plot5-&gt;getPlotter(), <a class="code" href="group__jkqtptools__math__statistics__regression.html#ggaa798f2573e7f03cb328b15ff76dda335a0421fde669f1f6a68f34f112af7c8809">JKQTPStatRegressionModelType::PowerLaw</a>, datastore1-&gt;begin(colNLLinX), datastore1-&gt;end(colNLLinX), datastore1-&gt;begin(colNLLinYPow), datastore1-&gt;end(colNLLinYPow));</div>
</div><!-- fragment --><p>... or even shorter:</p>
<div class="fragment"><div class="line"><a class="code" href="group__jkqtptools__math__statistics__adaptors.html#ga8ce3ce5c868aa676c9d7b29f35c037d6">jkqtpstatAddRegression</a>(graphD_exp, <a class="code" href="group__jkqtptools__math__statistics__regression.html#ggaa798f2573e7f03cb328b15ff76dda335ac1e19c09f700938f0ff7f1fd4722a3ac">JKQTPStatRegressionModelType::Exponential</a>);</div>
<div class="line"><a class="code" href="group__jkqtptools__math__statistics__adaptors.html#ga8ce3ce5c868aa676c9d7b29f35c037d6">jkqtpstatAddRegression</a>(graphD_powerlaw, <a class="code" href="group__jkqtptools__math__statistics__regression.html#ggaa798f2573e7f03cb328b15ff76dda335a0421fde669f1f6a68f34f112af7c8809">JKQTPStatRegressionModelType::PowerLaw</a>);</div>
</div><!-- fragment --><p>Also note that we used the function <code><a class="el" href="group__jkqtptools__math__statistics__regression.html#ga71e0e49a1e5aaba294f4b9f7b3f25201" title="calculate the linear regression coefficients for a given data range firstX / firstY ....">jkqtpstatRegression()</a></code> above, which performs a linear regression (internally uses <code><a class="el" href="group__jkqtptools__math__statistics__regression.html#gaf81a452c8e0798f6bb4b8764dd5a2f89" title="calculate the linear regression coefficients for a given data range firstX / firstY ....">jkqtpstatLinearRegression()</a></code>). But there also exist variants for robust IRLS regression adn weighted regression:</p><ul>
<li><code><a class="el" href="group__jkqtptools__math__statistics__regression.html#ga3907535ce3b98a3b0a4898d9eee1443f" title="calculate the robust linear regression coefficients for a given data range firstX / firstY ....">jkqtpstatRobustIRLSRegression()</a></code> / <code><a class="el" href="group__jkqtptools__math__statistics__adaptors.html#ga14b993381fd4bba889586b876459ae80" title="calculate the (robust) iteratively reweighted least-squares (IRLS) estimate for the parameters where ...">jkqtpstatAddRobustIRLSRegression()</a></code></li>
<li><code><a class="el" href="group__jkqtptools__math__statistics__regression.html#gaa6abec21468e0c369200d7fc92589531" title="calculate the robust linear regression coefficients for a given data range firstX / firstY ....">jkqtpstatWeightedRegression()</a></code> / <code><a class="el" href="group__jkqtptools__math__statistics__adaptors.html#gae5aca184e3e49753a18a403756bc89a7" title="calculate the weighted linear regression coefficients for a given for a given data range firstX / fir...">jkqtpstatAddWeightedRegression()</a></code></li>
</ul>
<h1><a class="anchor" id="autotoc_md50"></a>
Polynom Fitting</h1>
<p>Finally the <a class="el" href="group__jkqtptools__math__statistics.html">JKQTPlotter Statistics Library</a> also supports one option for non-linear model fitting, namely fitting of polynomial models. This is implemented in the function <code><a class="el" href="group__jkqtptools__math__statistics__poly.html#gaccc77ac9938ce987c232f5bee76b753d" title="fits (in a least-squares sense) a polynomial  of order P to a set of N data pairs">jkqtpstatPolyFit()</a></code>.</p>
<p>To demonstrate this function we first generate data from a poylnomial model (with gaussian noise):</p>
<div class="fragment"><div class="line">std::random_device rd; <span class="comment">// random number generators:</span></div>
<div class="line">std::mt19937 gen{rd()};</div>
<div class="line">std::normal_distribution&lt;&gt; d1{0,50};</div>
<div class="line">std::vector&lt;double&gt; pPoly {1,2,-2,0.5};</div>
<div class="line"><span class="keywordtype">size_t</span> colPolyX=datastore1-&gt;addColumn(<span class="stringliteral">&quot;polynomial data, x&quot;</span>);</div>
<div class="line"><span class="keywordtype">size_t</span> colPolyY=datastore1-&gt;addColumn(<span class="stringliteral">&quot;polynomial data, y&quot;</span>);</div>
<div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">double</span> x=-10; x&lt;=10; x++) {</div>
<div class="line">    datastore1-&gt;appendToColumn(colPolyX, x);</div>
<div class="line">    datastore1-&gt;appendToColumn(colPolyY, <a class="code" href="group__jkqtptools__math__basic.html#gaf1f20cb4d30238e749064094e9453289">jkqtp_polyEval</a>(x, pPoly.begin(), pPoly.end())+d1(gen));</div>
<div class="line">}</div>
</div><!-- fragment --><p>The function <code><a class="el" href="group__jkqtptools__math__basic.html#gaf1f20cb4d30238e749064094e9453289" title="evaluate a polynomial  with  taken from the range firstP ... lastP">jkqtp_polyEval()</a></code> is used to evaluate a given polynomial (coefficients in <code>pPoly</code>) at a position <code>x</code>.</p>
<p>The generated data is visualized with scatter-plots: </p><div class="fragment"><div class="line"><a class="code" href="class_j_k_q_t_p_x_y_line_graph.html">JKQTPXYLineGraph</a>* graphP;</div>
<div class="line">plot6-&gt;addGraph(graphP=<span class="keyword">new</span> <a class="code" href="class_j_k_q_t_p_x_y_line_graph.html">JKQTPXYLineGraph</a>(plot6));</div>
<div class="line">graphP-&gt;<a class="code" href="class_j_k_q_t_p_x_y_graph.html#a972ee50c53accadade8880b3bd1110cc">setXYColumns</a>(colPolyX, colPolyY);</div>
<div class="line">graphP-&gt;<a class="code" href="class_j_k_q_t_p_x_y_line_graph.html#a1202afd954530d0c71c9a745755f7ae0">setDrawLine</a>(<span class="keyword">false</span>);</div>
<div class="line">graphP-&gt;<a class="code" href="class_j_k_q_t_p_plot_element.html#a02a8d7c24cde7768f0134cee1aa1159d">setTitle</a>(QString(<span class="stringliteral">&quot;data $%1+\\mathcal{N}(0,50)$&quot;</span>).arg(<a class="code" href="group__jkqtptools__math__basic.html#ga5024e624b99918ad6b7c52d3474c43cd">jkqtp_polynomialModel2Latex</a>(pPoly.begin(), pPoly.end())));</div>
</div><!-- fragment --><p>Here the function <code><a class="el" href="group__jkqtptools__math__basic.html#ga5024e624b99918ad6b7c52d3474c43cd" title="Generates a LaTeX string for the polynomial model with the coefficients firstP ......">jkqtp_polynomialModel2Latex()</a></code> generates a string from a polynomial model.</p>
<p>Now we can call <code><a class="el" href="group__jkqtptools__math__statistics__poly.html#gaccc77ac9938ce987c232f5bee76b753d" title="fits (in a least-squares sense) a polynomial  of order P to a set of N data pairs">jkqtpstatPolyFit()</a></code> to fit different polynomial regression models to the data: </p><div class="fragment"><div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> p=0; p&lt;=5; p++) {</div>
<div class="line">    std::vector&lt;double&gt; pFit;</div>
<div class="line">    <a class="code" href="class_j_k_q_t_p_x_function_line_graph.html">JKQTPXFunctionLineGraph</a>* gPoly;</div>
<div class="line">    <a class="code" href="group__jkqtptools__math__statistics__poly.html#gaccc77ac9938ce987c232f5bee76b753d">jkqtpstatPolyFit</a>(datastore1-&gt;begin(colPolyX), datastore1-&gt;end(colPolyX), datastore1-&gt;begin(colPolyY), datastore1-&gt;end(colPolyY), p, std::back_inserter(pFit));</div>
<div class="line">    plot6-&gt;addGraph(gPoly=<span class="keyword">new</span> <a class="code" href="class_j_k_q_t_p_x_function_line_graph.html">JKQTPXFunctionLineGraph</a>(plot6));</div>
<div class="line">    gPoly-&gt;<a class="code" href="class_j_k_q_t_p_functor_line_graph_base.html#a45af61ac31bd9e6b26c662ea532920bf">setPlotFunctionFunctor</a>(<a class="code" href="group__jkqtptools__math__basic.html#gaf31e50999381fbbd25903be3fa3947b5">jkqtp_generatePolynomialModel</a>(pFit.begin(), pFit.end()));</div>
<div class="line">    gPoly-&gt;<a class="code" href="class_j_k_q_t_p_plot_element.html#a02a8d7c24cde7768f0134cee1aa1159d">setTitle</a>(QString(<span class="stringliteral">&quot;regression: $%1$&quot;</span>).arg(<a class="code" href="group__jkqtptools__math__basic.html#ga5024e624b99918ad6b7c52d3474c43cd">jkqtp_polynomialModel2Latex</a>(pFit.begin(), pFit.end())));</div>
<div class="line">}</div>
</div><!-- fragment --><p>Each model is also ploted using a <code><a class="el" href="class_j_k_q_t_p_x_function_line_graph.html" title="This implements line plots where the data is taken from a user supplied function .">JKQTPXFunctionLineGraph</a></code>. The plot function assigned to these <code><a class="el" href="class_j_k_q_t_p_x_function_line_graph.html" title="This implements line plots where the data is taken from a user supplied function .">JKQTPXFunctionLineGraph</a></code> is generated by calling <code><a class="el" href="group__jkqtptools__math__basic.html#gaf31e50999381fbbd25903be3fa3947b5" title="returns a C++-functor, which evaluates a polynomial">jkqtp_generatePolynomialModel()</a></code>, which returns a C++-functor for a polynomial.</p>
<p>The resulting plots look like this (without added gaussian noise):</p>
<p><img src="https://raw.githubusercontent.com/jkriege2/JKQtPlotter/master/screenshots/datastore_regression_polynom.png" alt="datastore_regression_polynom" class="inline"/></p>
<p>... and with added gaussian noise:</p>
<p><img src="https://raw.githubusercontent.com/jkriege2/JKQtPlotter/master/screenshots/datastore_regression_polynom_errros.png" alt="datastore_regression_polynom_errros" class="inline"/></p>
<p>Of course also the "adaptor" shortcuts are available: </p><div class="fragment"><div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> p=0; p&lt;=5; p++) {</div>
<div class="line">    <a class="code" href="group__jkqtptools__math__statistics__adaptors.html#gab2b033e358b57487592407d8b44f4c49">jkqtpstatAddPolyFit</a>(plot6-&gt;getPlotter(), datastore1-&gt;begin(colPolyX), datastore1-&gt;end(colPolyX), datastore1-&gt;begin(colPolyY), datastore1-&gt;end(colPolyY), p);</div>
<div class="line">    <a class="code" href="group__jkqtptools__math__statistics__adaptors.html#gab2b033e358b57487592407d8b44f4c49">jkqtpstatAddPolyFit</a>(graphP, p);</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md51"></a>
Screenshot of the full Program</h1>
<p>The output of the full test program <a href="https://github.com/jkriege2/JKQtPlotter/tree/master/examples/datastore_statistics/datastore_regression.cpp"><code>datastore_regression.cpp</code></a> looks like this:</p>
<p><img src="https://raw.githubusercontent.com/jkriege2/JKQtPlotter/master/screenshots/datastore_regression.png" alt="datastore_regression" class="inline"/> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div class="ttc" id="aclass_j_k_q_t_p_functor_line_graph_base_html_a54839fbc43deffbd05aa204322b5443d"><div class="ttname"><a href="class_j_k_q_t_p_functor_line_graph_base.html#a54839fbc43deffbd05aa204322b5443d">JKQTPFunctorLineGraphBase::setSpecialFunction</a></div><div class="ttdeci">void setSpecialFunction(SpecialFunction function)</div><div class="ttdoc">sets function to the given special function</div></div>
<div class="ttc" id="aclass_j_k_q_t_p_y_graph_error_data_html_a52350a8da0cbce7a98e6da445ad28b11"><div class="ttname"><a href="class_j_k_q_t_p_y_graph_error_data.html#a52350a8da0cbce7a98e6da445ad28b11">JKQTPYGraphErrorData::setYErrorColumn</a></div><div class="ttdeci">void setYErrorColumn(int __value)</div><div class="ttdoc">the column that contains the error of the x-component of the datapoints</div></div>
<div class="ttc" id="aclass_j_k_q_t_p_plot_element_html_a02a8d7c24cde7768f0134cee1aa1159d"><div class="ttname"><a href="class_j_k_q_t_p_plot_element.html#a02a8d7c24cde7768f0134cee1aa1159d">JKQTPPlotElement::setTitle</a></div><div class="ttdeci">virtual void setTitle(const QString &amp;__value)</div><div class="ttdoc">sets the title of the plot (for display in key!).</div></div>
<div class="ttc" id="agroup__jkqtptools__math__basic_html_gaf31e50999381fbbd25903be3fa3947b5"><div class="ttname"><a href="group__jkqtptools__math__basic.html#gaf31e50999381fbbd25903be3fa3947b5">jkqtp_generatePolynomialModel</a></div><div class="ttdeci">std::function&lt; double(double)&gt; jkqtp_generatePolynomialModel(PolyItP firstP, PolyItP lastP)</div><div class="ttdoc">returns a C++-functor, which evaluates a polynomial</div><div class="ttdef"><b>Definition:</b> jkqtpmathtools.h:500</div></div>
<div class="ttc" id="agroup__jkqtptools__math__basic_html_gad8ae0cbd634f3079f88d87310504d62e"><div class="ttname"><a href="group__jkqtptools__math__basic.html#gad8ae0cbd634f3079f88d87310504d62e">jkqtp_approximatelyEqual</a></div><div class="ttdeci">bool jkqtp_approximatelyEqual(float a, float b, float epsilon=2.0f *JKQTP_FLOAT_EPSILON)</div><div class="ttdoc">compare two floats a and b for euqality, where any difference smaller than epsilon is seen as equalit...</div><div class="ttdef"><b>Definition:</b> jkqtpmathtools.h:248</div></div>
<div class="ttc" id="aclass_j_k_q_t_p_evaluated_function_graph_base_html_aa3f1098c5ab09c8be6dca50346254205"><div class="ttname"><a href="class_j_k_q_t_p_evaluated_function_graph_base.html#aa3f1098c5ab09c8be6dca50346254205">JKQTPEvaluatedFunctionGraphBase::setParamsV</a></div><div class="ttdeci">void setParamsV(double p1)</div><div class="ttdoc">set an internal parameter vector as function parameters, initialized with {p1}</div></div>
<div class="ttc" id="aclass_j_k_q_t_p_x_function_line_graph_html"><div class="ttname"><a href="class_j_k_q_t_p_x_function_line_graph.html">JKQTPXFunctionLineGraph</a></div><div class="ttdoc">This implements line plots where the data is taken from a user supplied function .</div><div class="ttdef"><b>Definition:</b> jkqtpevaluatedfunction.h:286</div></div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__regression_html_ga4d8e68bdb86c24be6ef6595135697988"><div class="ttname"><a href="group__jkqtptools__math__statistics__regression.html#ga4d8e68bdb86c24be6ef6595135697988">jkqtpStatGenerateRegressionModel</a></div><div class="ttdeci">JKQTCOMMON_LIB_EXPORT std::function&lt; double(double, double, double)&gt; jkqtpStatGenerateRegressionModel(JKQTPStatRegressionModelType type)</div><div class="ttdoc">Generates functors f(x,a,b) for the models from JKQTPStatRegressionModelType in type.</div></div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__adaptors_html_ga9f4f7d2237a4d285dfd76b45084b0cd5"><div class="ttname"><a href="group__jkqtptools__math__statistics__adaptors.html#ga9f4f7d2237a4d285dfd76b45084b0cd5">jkqtpstatAddRobustIRLSLinearRegression</a></div><div class="ttdeci">JKQTPXFunctionLineGraph * jkqtpstatAddRobustIRLSLinearRegression(JKQTBasePlotter *plotter, InputItX firstX, InputItX lastX, InputItY firstY, InputItY lastY, double *coeffA=nullptr, double *coeffB=nullptr, bool fixA=false, bool fixB=false, double p=1.1, int iterations=100)</div><div class="ttdoc">calculate the (robust) iteratively reweighted least-squares (IRLS) estimate for the parameters of the...</div><div class="ttdef"><b>Definition:</b> jkqtpstatisticsadaptors.h:1830</div></div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__regression_html_ga4d5788af55f493f384915cf012980432"><div class="ttname"><a href="group__jkqtptools__math__statistics__regression.html#ga4d5788af55f493f384915cf012980432">jkqtpstatRegressionModel2Latex</a></div><div class="ttdeci">JKQTCOMMON_LIB_EXPORT QString jkqtpstatRegressionModel2Latex(JKQTPStatRegressionModelType type, double a, double b)</div><div class="ttdoc">Generates a LaTeX string for the models from JKQTPStatRegressionModelType in type.</div></div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__adaptors_html_ga72f5744b994b78860ab0e9e9e560ce2b"><div class="ttname"><a href="group__jkqtptools__math__statistics__adaptors.html#ga72f5744b994b78860ab0e9e9e560ce2b">jkqtpstatAddLinearRegression</a></div><div class="ttdeci">JKQTPXFunctionLineGraph * jkqtpstatAddLinearRegression(JKQTBasePlotter *plotter, InputItX firstX, InputItX lastX, InputItY firstY, InputItY lastY, double *coeffA=nullptr, double *coeffB=nullptr, bool fixA=false, bool fixB=false)</div><div class="ttdoc">calculate the linear regression coefficients for a given data range firstX / firstY ....</div><div class="ttdef"><b>Definition:</b> jkqtpstatisticsadaptors.h:1754</div></div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__regression_html_gab5c23e5d003ffde1fbf9a089ea454659"><div class="ttname"><a href="group__jkqtptools__math__statistics__regression.html#gab5c23e5d003ffde1fbf9a089ea454659">jkqtpstatLinearWeightedRegression</a></div><div class="ttdeci">void jkqtpstatLinearWeightedRegression(InputItX firstX, InputItX lastX, InputItY firstY, InputItY lastY, InputItW firstW, InputItW lastW, double &amp;coeffA, double &amp;coeffB, bool fixA=false, bool fixB=false, std::function&lt; double(double)&gt; fWeightDataToWi=&amp;jkqtp_identity&lt; double &gt;)</div><div class="ttdoc">calculate the weighted linear regression coefficients for a given for a given data range firstX / fir...</div><div class="ttdef"><b>Definition:</b> jkqtpstatregression.h:144</div></div>
<div class="ttc" id="agroup__jkqtptools__string_html_ga4f7343eadd4604477092123377981777"><div class="ttname"><a href="group__jkqtptools__string.html#ga4f7343eadd4604477092123377981777">jkqtp_floattolatexqstr</a></div><div class="ttdeci">JKQTCOMMON_LIB_EXPORT QString jkqtp_floattolatexqstr(double data, int past_comma=5, bool remove_trail0=false, double belowIsZero=1e-16, double minNoExponent=1e-3, double maxNoExponent=1e4, bool ensurePlusMinus=false)</div><div class="ttdoc">convert a double to a string, encoding powers of ten as exponent in LaTeX notation (e....</div></div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__regression_html_ggaa798f2573e7f03cb328b15ff76dda335a0421fde669f1f6a68f34f112af7c8809"><div class="ttname"><a href="group__jkqtptools__math__statistics__regression.html#ggaa798f2573e7f03cb328b15ff76dda335a0421fde669f1f6a68f34f112af7c8809">JKQTPStatRegressionModelType::PowerLaw</a></div><div class="ttdeci">@ PowerLaw</div><div class="ttdoc">power law model</div></div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__regression_html_ggaa798f2573e7f03cb328b15ff76dda335ac1e19c09f700938f0ff7f1fd4722a3ac"><div class="ttname"><a href="group__jkqtptools__math__statistics__regression.html#ggaa798f2573e7f03cb328b15ff76dda335ac1e19c09f700938f0ff7f1fd4722a3ac">JKQTPStatRegressionModelType::Exponential</a></div><div class="ttdeci">@ Exponential</div><div class="ttdoc">exponential model</div></div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__adaptors_html_gab2b033e358b57487592407d8b44f4c49"><div class="ttname"><a href="group__jkqtptools__math__statistics__adaptors.html#gab2b033e358b57487592407d8b44f4c49">jkqtpstatAddPolyFit</a></div><div class="ttdeci">JKQTPXFunctionLineGraph * jkqtpstatAddPolyFit(JKQTBasePlotter *plotter, InputItX firstX, InputItX lastX, InputItY firstY, InputItY lastY, size_t P, OutputItP firstRes)</div><div class="ttdoc">fits (in a least-squares sense) a polynomial  of order P to a set of N data pairs  from a given data ...</div><div class="ttdef"><b>Definition:</b> jkqtpstatisticsadaptors.h:2249</div></div>
<div class="ttc" id="aclass_j_k_q_t_p_functor_line_graph_base_html_a45af61ac31bd9e6b26c662ea532920bf"><div class="ttname"><a href="class_j_k_q_t_p_functor_line_graph_base.html#a45af61ac31bd9e6b26c662ea532920bf">JKQTPFunctorLineGraphBase::setPlotFunctionFunctor</a></div><div class="ttdeci">virtual void setPlotFunctionFunctor(jkqtpPlotFunctionType &amp;&amp;__value)</div><div class="ttdoc">sets a functor to be plotted</div></div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__regression_html_gaf81a452c8e0798f6bb4b8764dd5a2f89"><div class="ttname"><a href="group__jkqtptools__math__statistics__regression.html#gaf81a452c8e0798f6bb4b8764dd5a2f89">jkqtpstatLinearRegression</a></div><div class="ttdeci">void jkqtpstatLinearRegression(InputItX firstX, InputItX lastX, InputItY firstY, InputItY lastY, double &amp;coeffA, double &amp;coeffB, bool fixA=false, bool fixB=false)</div><div class="ttdoc">calculate the linear regression coefficients for a given data range firstX / firstY ....</div><div class="ttdef"><b>Definition:</b> jkqtpstatregression.h:71</div></div>
<div class="ttc" id="agroup__jkqtptools__math__basic_html_ga5024e624b99918ad6b7c52d3474c43cd"><div class="ttname"><a href="group__jkqtptools__math__basic.html#ga5024e624b99918ad6b7c52d3474c43cd">jkqtp_polynomialModel2Latex</a></div><div class="ttdeci">QString jkqtp_polynomialModel2Latex(PolyItP firstP, PolyItP lastP)</div><div class="ttdoc">Generates a LaTeX string for the polynomial model with the coefficients firstP ......</div><div class="ttdef"><b>Definition:</b> jkqtpmathtools.h:512</div></div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__adaptors_html_ga03bbbd1a83a63cb7eb14eee9c3a73a34"><div class="ttname"><a href="group__jkqtptools__math__statistics__adaptors.html#ga03bbbd1a83a63cb7eb14eee9c3a73a34">jkqtpstatAddLinearWeightedRegression</a></div><div class="ttdeci">JKQTPXFunctionLineGraph * jkqtpstatAddLinearWeightedRegression(JKQTBasePlotter *plotter, InputItX firstX, InputItX lastX, InputItY firstY, InputItY lastY, InputItW firstW, InputItW lastW, double *coeffA=nullptr, double *coeffB=nullptr, bool fixA=false, bool fixB=false, std::function&lt; double(double)&gt; fWeightDataToWi=&amp;jkqtp_identity&lt; double &gt;)</div><div class="ttdoc">calculate the weighted linear regression coefficients for a given for a given data range firstX / fir...</div><div class="ttdef"><b>Definition:</b> jkqtpstatisticsadaptors.h:1918</div></div>
<div class="ttc" id="aclass_j_k_q_t_p_x_y_line_graph_html_a1202afd954530d0c71c9a745755f7ae0"><div class="ttname"><a href="class_j_k_q_t_p_x_y_line_graph.html#a1202afd954530d0c71c9a745755f7ae0">JKQTPXYLineGraph::setDrawLine</a></div><div class="ttdeci">void setDrawLine(bool __value)</div><div class="ttdoc">indicates whether to draw a line or not</div></div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__regression_html_ga71e0e49a1e5aaba294f4b9f7b3f25201"><div class="ttname"><a href="group__jkqtptools__math__statistics__regression.html#ga71e0e49a1e5aaba294f4b9f7b3f25201">jkqtpstatRegression</a></div><div class="ttdeci">void jkqtpstatRegression(JKQTPStatRegressionModelType type, InputItX firstX, InputItX lastX, InputItY firstY, InputItY lastY, double &amp;coeffA, double &amp;coeffB, bool fixA=false, bool fixB=false)</div><div class="ttdoc">calculate the linear regression coefficients for a given data range firstX / firstY ....</div><div class="ttdef"><b>Definition:</b> jkqtpstatregression.h:338</div></div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__regression_html_ga7da14476c0d4bc417ec104dbcc930bb6"><div class="ttname"><a href="group__jkqtptools__math__statistics__regression.html#ga7da14476c0d4bc417ec104dbcc930bb6">jkqtpstatRobustIRLSLinearRegression</a></div><div class="ttdeci">void jkqtpstatRobustIRLSLinearRegression(InputItX firstX, InputItX lastX, InputItY firstY, InputItY lastY, double &amp;coeffA, double &amp;coeffB, bool fixA=false, bool fixB=false, double p=1.1, int iterations=100)</div><div class="ttdoc">calculate the (robust) iteratively reweighted least-squares (IRLS) estimate for the parameters of the...</div><div class="ttdef"><b>Definition:</b> jkqtpstatregression.h:229</div></div>
<div class="ttc" id="aclass_j_k_q_t_p_x_y_graph_html_a972ee50c53accadade8880b3bd1110cc"><div class="ttname"><a href="class_j_k_q_t_p_x_y_graph.html#a972ee50c53accadade8880b3bd1110cc">JKQTPXYGraph::setXYColumns</a></div><div class="ttdeci">void setXYColumns(size_t xCol, size_t yCol)</div><div class="ttdoc">sets xColumn and yColumn at the same time</div></div>
<div class="ttc" id="aclass_j_k_q_t_p_x_y_line_graph_html"><div class="ttname"><a href="class_j_k_q_t_p_x_y_line_graph.html">JKQTPXYLineGraph</a></div><div class="ttdoc">This implements xy line plots. This also alows to draw symbols at the data points.</div><div class="ttdef"><b>Definition:</b> jkqtpscatter.h:56</div></div>
<div class="ttc" id="aclass_j_k_q_t_p_x_y_line_error_graph_html"><div class="ttname"><a href="class_j_k_q_t_p_x_y_line_error_graph.html">JKQTPXYLineErrorGraph</a></div><div class="ttdoc">This implements xy line plots with x and y error indicators.</div><div class="ttdef"><b>Definition:</b> jkqtpscatter.h:375</div></div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__poly_html_gaccc77ac9938ce987c232f5bee76b753d"><div class="ttname"><a href="group__jkqtptools__math__statistics__poly.html#gaccc77ac9938ce987c232f5bee76b753d">jkqtpstatPolyFit</a></div><div class="ttdeci">void jkqtpstatPolyFit(InputItX firstX, InputItX lastX, InputItY firstY, InputItY lastY, size_t P, OutputItP firstRes)</div><div class="ttdoc">fits (in a least-squares sense) a polynomial  of order P to a set of N data pairs</div><div class="ttdef"><b>Definition:</b> jkqtpstatpoly.h:70</div></div>
<div class="ttc" id="agroup__jkqtptools__math__basic_html_gaf1f20cb4d30238e749064094e9453289"><div class="ttname"><a href="group__jkqtptools__math__basic.html#gaf1f20cb4d30238e749064094e9453289">jkqtp_polyEval</a></div><div class="ttdeci">double jkqtp_polyEval(double x, PolyItP firstP, PolyItP lastP)</div><div class="ttdoc">evaluate a polynomial  with  taken from the range firstP ... lastP</div><div class="ttdef"><b>Definition:</b> jkqtpmathtools.h:467</div></div>
<div class="ttc" id="agroup__jkqtptools__math__statistics__adaptors_html_ga8ce3ce5c868aa676c9d7b29f35c037d6"><div class="ttname"><a href="group__jkqtptools__math__statistics__adaptors.html#ga8ce3ce5c868aa676c9d7b29f35c037d6">jkqtpstatAddRegression</a></div><div class="ttdeci">JKQTPXFunctionLineGraph * jkqtpstatAddRegression(JKQTBasePlotter *plotter, JKQTPStatRegressionModelType type, InputItX firstX, InputItX lastX, InputItY firstY, InputItY lastY, double *coeffA=nullptr, double *coeffB=nullptr, bool fixA=false, bool fixB=false)</div><div class="ttdoc">calculate the linear regression coefficients for a given data range firstX / firstY ....</div><div class="ttdef"><b>Definition:</b> jkqtpstatisticsadaptors.h:2004</div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="example_tutorial_projects.html">Example &amp; Tutorial Projects</a></li>
    <li class="footer">Generated on Sat Sep 19 2020 18:03:18 for JKQTPlotter by <a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
